<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>MariaDB for Universities Program: Course Material</title>
<link rel=stylesheet href=/css/main.css><meta property="og:url" content="https://uni.mariadb.org/dev/programming/"><meta property="og:site_name" content="MariaDB for Universities Program Course Material"><meta property="og:title" content="Lesson 5: Programming"><meta property="og:description" content="Programming Learning objectives Differentiate between stored procedures and stored functions using the native MariaDB SQL/PSM language Use JSON document stores Understand how to access MariaDB via APIs using both native and non-native MariaDB connectors Set SQL modes to affect error output and use the SHOW WARNINGS and SHOW ERRORS statements to interpret error messages JSON Relational + JSON How to use hybrid data models
Relational
data integrity, transactions and reliability"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="dev"><meta property="article:published_time" content="2025-04-10T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-10T00:00:00+00:00"></head><body><div class=top-menu><div class=menu-left><a href=/ class=home-link><img src=# alt class=menu-icon>
MariaDB for Universities Program: Course Material</a></div><div class=menu-right><a href=https://mariadb.org>MariaDB Foundation (mariadb.org)</a></div></div><div class=content-wrapper><div class=left-menu><div class=table-of-contents><h2><a href=.>Lesson 5: Programming</a></h2><nav id=TableOfContents><ul><li><a href=#learning-objectives>Learning objectives</a></li><li><a href=#json>JSON</a><ul><li><a href=#relational--json>Relational + JSON</a></li><li><a href=#relational--json-1>Relational + JSON</a></li><li><a href=#define>Define</a></li><li><a href=#create>Create</a></li><li><a href=#read-field>Read field</a></li><li><a href=#null-field>Null field</a></li><li><a href=#contains-field>Contains field</a></li><li><a href=#contains-value>Contains value</a></li><li><a href=#read-array>Read array</a></li><li><a href=#read-array-element>Read array element</a></li><li><a href=#read-object>Read object</a></li><li><a href=#read-objects>Read objects</a></li><li><a href=#field-equals>Field equals</a></li><li><a href=#indexing>Indexing</a></li><li><a href=#indexing-1>Indexing</a></li><li><a href=#insert-field>Insert field</a></li><li><a href=#insert-array>Insert array</a></li><li><a href=#add-array-element>Add array element</a></li><li><a href=#remove-array-element>Remove array element</a></li><li><a href=#relational-to-json>Relational to JSON</a></li><li><a href=#relational--json-2>Relational + JSON</a></li><li><a href=#relational--json-merge>Relational + JSON (merge)</a></li><li><a href=#constraints>Constraints</a></li><li><a href=#constraints-1>Constraints</a></li><li><a href=#constraints-2>Constraints</a></li></ul></li><li><a href=#accessing-mariadb-with-apis>Accessing MariaDB with APIs</a><ul><li><a href=#application-program-interface-api>Application program interface (API)</a></li><li><a href=#minimal-steps-for-an-application>Minimal steps for an application</a></li><li><a href=#api-database-user-account>Api database user account</a></li><li><a href=#installing-and-configuring---java>Installing and configuring - Java</a></li><li><a href=#connecting-to-mariadb---java>Connecting to MariaDB - Java</a></li><li><a href=#querying-mariadb---java>Querying MariaDB - Java</a></li><li><a href=#installing-and-configuring---r2dbc>Installing and configuring - R2DBC</a></li><li><a href=#connecting-to-mariadb---r2dbc>Connecting to MariaDB - R2DBC</a></li><li><a href=#querying-mariadb---r2dbc>Querying MariaDB - R2DBC</a></li><li><a href=#installing-and-configuring---nodejs>Installing and configuring - Node.js</a></li><li><a href=#connecting-to-mariadb---nodejs>Connecting to MariaDB - Node.js</a></li><li><a href=#querying-mariadb---nodejs>Querying MariaDB - Node.js</a></li><li><a href=#installing-and-configuring---python>Installing and configuring - Python</a></li><li><a href=#connecting-to-mariadb---python>Connecting to MariaDB - Python</a></li><li><a href=#querying-mariadb---python>Querying MariaDB - Python</a></li><li><a href=#installing-and-configuring---c>Installing and configuring - C++</a></li><li><a href=#connecting-to-mariadb---c>Connecting to MariaDB - C++</a></li><li><a href=#querying-mariadb---c>Querying MariaDB - C++</a></li><li><a href=#installing-and-configuring---c-1>Installing and configuring - C</a></li><li><a href=#connecting-to-mariadb---c-1>Connecting to MariaDB - C</a></li><li><a href=#querying-mariadb---c-1>Querying MariaDB - C</a></li></ul></li><li><a href=#non-native-mariadb-connectors>Non-native MariaDB connectors</a><ul><li><a href=#installing-and-configuring---net>Installing and configuring - .NET</a></li><li><a href=#connecting-to-mariadb---net>Connecting to MariaDB - .NET</a></li><li><a href=#querying-mariadb---net>Querying MariaDB - .NET</a></li><li><a href=#installing-and-configuring---php>Installing and configuring - PHP</a></li><li><a href=#connecting-to-mariadb---php>Connecting to MariaDB - PHP</a></li><li><a href=#querying-mariadb---php>Querying MariaDB - PHP</a></li><li><a href=#other-database-connectors>Other database connectors</a></li><li><a href=#object-relational-mapping-orm>Object-relational mapping (ORM)</a></li></ul></li><li><a href=#error-and-warning-handling>Error and warning handling</a><ul><li><a href=#sql-errors-and-warnings>SQL errors and warnings</a></li><li><a href=#operating-system-errors>Operating system errors</a></li><li><a href=#domain-name-service>Domain name service</a></li><li><a href=#persistent-connections>Persistent connections</a></li><li><a href=#avoiding-divide-by-zero>Avoiding divide by zero</a></li></ul></li><li><a href=#lesson-summary>Lesson summary</a></li><li><a href=#lab-exercises>Lab exercises</a></li></ul></nav></div></div><div class=main-content><nav class=breadcrumb><a href=/>MariaDB for Universities Course Material</a>
>
<a href=/dev/>MariaDB Developer Course</a>
> <span class=current>Lesson 5: Programming</span></nav><h1>Lesson 5: Programming</h1><h1 id=programming>Programming</h1><h2 id=learning-objectives>Learning objectives</h2><ul><li>Differentiate between stored procedures and stored functions using the native MariaDB SQL/PSM language</li><li>Use JSON document stores</li><li>Understand how to access MariaDB via APIs using both native and non-native MariaDB connectors</li><li>Set SQL modes to affect error output and use the SHOW WARNINGS and SHOW ERRORS statements to interpret error messages</li></ul><h2 id=json>JSON</h2><h3 id=relational--json>Relational + JSON</h3><p><strong>How to use hybrid data models</strong></p><p><strong>Relational</strong><br>data integrity, transactions and reliability</p><p><strong>JSON</strong><br>flexibility, simplicity and ubiquity</p><ul><li>JSON data type since 10.2</li><li>Many JSON functions available besides schema support</li><li>Indexing for faster retrieval is possible</li><li>Stored as <code>LONGTEXT</code> in <code>mysqldump</code></li></ul><p><strong>A data model can be comprised of structured and semi-structured data</strong></p><ul><li>Structured data is externally described</li><li>Semi-structured data is self described</li></ul><h3 id=relational--json-1>Relational + JSON</h3><table><thead><tr><th>Name</th><th>Format</th><th>Price</th><th>Video</th></tr></thead><tbody><tr><td>Aliens</td><td>Blu-ray</td><td>13.99</td><td><code>{"resolution": "1080p", "aspectRatio": "1.85:1"}</code></td></tr></tbody></table><p><strong>Structured</strong></p><p>Structure described by the schema</p><p><strong>Semi-structured</strong></p><p>Structure described by the data</p><h3 id=define>Define</h3><h4 id=creating-and-querying-json-documents>Creating and Querying JSON Documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TABLE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>IF</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>EXISTS</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span>(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>id<span style=color:#bbb> </span><span style=color:#007020>INT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>PRIMARY</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>KEY</span><span style=color:#bbb> </span>AUTO_INCREMENT,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#007020>VARCHAR</span>(<span style=color:#40a070>1</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>name<span style=color:#bbb> </span><span style=color:#007020>VARCHAR</span>(<span style=color:#40a070>40</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>format<span style=color:#bbb> </span><span style=color:#007020>VARCHAR</span>(<span style=color:#40a070>20</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>price<span style=color:#bbb> </span><span style=color:#007020>FLOAT</span>(<span style=color:#40a070>5</span>,<span style=color:#bbb> </span><span style=color:#40a070>2</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>attr<span style=color:#bbb> </span>JSON<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=create>Create</h3><h4 id=creating-and-querying-json-documents-1>Creating and querying JSON documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span>(<span style=color:#007020;font-weight:700>type</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span>attr)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>(<span style=color:#4070a0>&#39;M&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Aliens&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Blu-ray&#39;</span>,<span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span>,<span style=color:#4070a0>&#39;{&#34;video&#34;: {&#34;resolution&#34;: &#34;1080p&#34;, &#34;aspectRatio&#34;: &#34;1.85:1&#34;}, &#34;cuts&#34;:
</span></span></span><span style=display:flex><span><span style=color:#4070a0>    [{&#34;name&#34;: &#34;Theatrical&#34;, &#34;runtime&#34;: 138}, {&#34;name&#34;: &#34;Special Edition&#34;, &#34;runtime&#34;: 155}], &#34;audio&#34;:
</span></span></span><span style=display:flex><span><span style=color:#4070a0>    [&#34;DTS HD&#34;, &#34;Dolby Surround&#34;]}&#39;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span>(<span style=color:#007020;font-weight:700>type</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span>attr)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>(<span style=color:#4070a0>&#39;B&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Foundation&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Paperback&#39;</span>,<span style=color:#bbb> </span><span style=color:#40a070>7</span>.<span style=color:#40a070>99</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;{&#34;author&#34;: &#34;Isaac Asimov&#34;, &#34;page_count&#34;: 296}&#39;</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=read-field>Read field</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_VALUE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video.aspectRatio&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>aspect_ratio<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Aspect_ratio<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|--------|-------|--------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>.<span style=color:#40a070>85</span>:<span style=color:#40a070>1</span><span style=color:#bbb>       </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=null-field>Null field</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_VALUE(attr,<span>$</span>.video.aspectRatio<span style=color:#4070a0>&#39;) AS aspect_ratio
</span></span></span><span style=display:flex><span><span style=color:#4070a0>FROM products;
</span></span></span><span style=display:flex><span><span style=color:#4070a0>
</span></span></span><span style=display:flex><span><span style=color:#4070a0>| Type | Name       | Format    | Price | Aspect_ratio |
</span></span></span><span style=display:flex><span><span style=color:#4070a0>|------|------------|-----------|-------|--------------|
</span></span></span><span style=display:flex><span><span style=color:#4070a0>| M    | Aliens     | Blue-ray  | 13.99 | 1.85:1       |
</span></span></span><span style=display:flex><span><span style=color:#4070a0>| B    | Foundation | Paperback | 7.99  | NULL         |
</span></span></span></code></pre></div><h3 id=contains-field>Contains field</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_VALUE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video.aspectRatio&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>aspect_ratio<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AND</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_CONTAINS_PATH(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;one&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video.resolution&#39;</span>)<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Aspect_ratio<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>-------|--------|-------|--------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>.<span style=color:#40a070>85</span>:<span style=color:#40a070>1</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=contains-value>Contains value</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>id,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AND</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>JSON_CONTAINS(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;\&#34;DTS HD\&#34;&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.audio&#39;</span>)<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Aspect_ratio<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|--------|-------|--------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>.<span style=color:#40a070>85</span>:<span style=color:#40a070>1</span><span style=color:#bbb>       </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=read-array>Read array</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>   </span>JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.audio&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>audio<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Audio<span style=color:#bbb>                          </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|--------|-------|--------------------------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#4070a0>&#34;DTS HD&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;Dolby Surround&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=read-array-element>Read array element</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>JSON_VALUE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.audio[0]&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>default_audio<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Audio<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>-------|--------|-------|------- |
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>DTS<span style=color:#bbb> </span>HD<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=read-object>Read object</h3><h4 id=creating-and-querying-json-documents-2>Creating and querying JSON documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>video<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Video<span style=color:#bbb>                                    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>-------|--------|-------|------------------------------------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span>{</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34;resolution&#34;</span>:<span style=color:#bbb> </span><span style=color:#4070a0>&#34;1080p&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;aspectRatio&#34;</span>:<span style=color:#bbb> </span><span style=color:#4070a0>&#34;1.85:1&#34;</span><span style=color:#bbb> </span><span>}</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=read-objects>Read objects</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.audio&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>audio,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>video<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Audio<span style=color:#bbb>                           </span><span style=color:#666>|</span><span style=color:#bbb> </span>Video<span style=color:#bbb>                                    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|---------------------------------|------------------------------------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#4070a0>&#34;DTS HD&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;Dolby Surround&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span><span>{</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34;resolution&#34;</span>:<span style=color:#bbb> </span><span style=color:#4070a0>&#34;1080p&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;aspectRatio&#34;</span>:<span style=color:#bbb> </span><span style=color:#4070a0>&#34;1.85:1&#34;</span><span style=color:#bbb> </span><span>}</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=field-equals>Field equals</h3><p>Creating and Querying JSON Documents</p><pre><code>SELECT id, name, format, price
FROM products
WHERE type = 'M' AND
    JSON_VALUE(attr, '$.video.resolution') = '1080p';
</code></pre><table><thead><tr><th>Name</th><th>Format</th><th>Price</th><th>Aspect_ratio</th></tr></thead><tbody><tr><td>Aliens</td><td>Blu-ray</td><td>13.99</td><td>1.85:1</td></tr></tbody></table><h3 id=indexing>Indexing</h3><p>Creating and Querying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>ALTER</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TABLE</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ADD</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>COLUMN</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>video_resolution<span style=color:#bbb> </span><span style=color:#007020>VARCHAR</span>(<span style=color:#40a070>5</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>(JSON_VALUE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video.resolution&#39;</span>))<span style=color:#bbb> </span>VIRTUAL;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>EXPLAIN</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>video_resolution<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;1080p&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>ID<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Select_type<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>Table</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>Type</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Possible_keys<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>----|-------------|----------|------|---------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SIMPLE</span><span style=color:#bbb>      </span><span style=color:#666>|</span><span style=color:#bbb> </span>Products<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ALL</span><span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span><span style=color:#bbb>          </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=indexing-1>Indexing</h3><h4 id=creating-and-querying-json-documents-3>Creating and Querying JSON Documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INDEX</span><span style=color:#bbb> </span>resolutions<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span>products(video_resolution);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>EXPLAIN</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>video_resolution<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;1080p&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>ID<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span>Select_type<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>Table</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>Ref</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Possible_keys<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#60a0b0;font-style:italic>--- | ----------- | -------- | --- | ------------- |
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SIMPLE</span><span style=color:#bbb>      </span><span style=color:#666>|</span><span style=color:#bbb> </span>Products<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ref</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>resolutions<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=insert-field>Insert field</h3><h4 id=modifying-json-documents>Modifying JSON documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span>attr<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>JSON_INSERT(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.disks&#39;</span>,<span style=color:#bbb> </span><span style=color:#40a070>1</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>id<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_VALUE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.disks&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>disks<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Disks<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|--------|-------|-------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb>     </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=insert-array>Insert array</h3><p>Modifying JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span>attr<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>JSON_INSERT(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.languages&#39;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>JSON_ARRAY(<span style=color:#4070a0>&#39;English&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;French&#39;</span>))<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>id<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span>JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.languages&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>languages<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Languages<span style=color:#bbb>      </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|--------|-------|----------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>[<span style=color:#4070a0>&#34;English&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;French&#34;</span>]<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=add-array-element>Add array element</h3><h4 id=modifying-json-documents-1>Modifying JSON Documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span>attr<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>JSON_ARRAY_APPEND(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.languages&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Spanish&#39;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>id<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span>JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.languages&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>languages<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Languages<span style=color:#bbb>                           </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|--------|-------|-------------------------------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#4070a0>&#34;English&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;French&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;Spanish&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=remove-array-element>Remove array element</h3><h4 id=modifying-json-documents-2>Modifying JSON Documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span>attr<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>JSON_REMOVE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.languages[0]&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>id<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span>JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.languages&#39;</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>languages<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Format<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Price<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Languages<span style=color:#bbb>                </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>--------|--------|-------|--------------------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Aliens<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Blu<span style=color:#666>-</span>ray<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>13</span>.<span style=color:#40a070>99</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#4070a0>&#34;French&#34;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;Spanish&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=relational-to-json>Relational to JSON</h3><h4 id=creating-json-documents-from-relational-data>Creating JSON Documents From Relational Data</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>JSON_OBJECT(<span style=color:#4070a0>&#39;name&#39;</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;format&#39;</span>,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;price&#39;</span>,<span style=color:#bbb> </span>price)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>DATA</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><h4 id=data>Data</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;name&#34;</span>: <span style=color:#4070a0>&#34;Tron&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;format&#34;</span>: <span style=color:#4070a0>&#34;Blu-ray&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;price&#34;</span>: <span style=color:#40a070>29.99</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=relational--json-2>Relational + JSON</h3><h4 id=creating-json-documents-from-relational-data-1>Creating JSON Documents From Relational Data</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>JSON_OBJECT(<span style=color:#4070a0>&#39;name&#39;</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;format&#39;</span>,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;price&#39;</span>,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;resolution&#39;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_VALUE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video.resolution&#39;</span>))<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>DATA</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><h4 id=data-1>Data</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#062873;font-weight:700>&#34;name&#34;</span>: <span style=color:#4070a0>&#34;Aliens&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#062873;font-weight:700>&#34;format&#34;</span>: <span style=color:#4070a0>&#34;Blu-ray&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#062873;font-weight:700>&#34;price&#34;</span>: <span style=color:#40a070>13.99</span>,
</span></span><span style=display:flex><span>    <span style=color:#062873;font-weight:700>&#34;resolution&#34;</span>: <span style=color:#4070a0>&#34;1080p&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=relational--json-merge>Relational + JSON (merge)</h3><h4 id=creating-json-documents-from-relational-data-2>Creating JSON Documents From Relational Data</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>JSON_MERGE(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>JSON_OBJECT(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#4070a0>&#39;name&#39;</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#4070a0>&#39;format&#39;</span>,<span style=color:#bbb> </span>format),<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>attr)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>DATA</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>products<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><h4 id=data-2>Data</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;name&#34;</span>: <span style=color:#4070a0>&#34;Tron&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;format&#34;</span>: <span style=color:#4070a0>&#34;Blu-ray&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;video&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#062873;font-weight:700>&#34;resolution&#34;</span>: <span style=color:#4070a0>&#34;1080p&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#062873;font-weight:700>&#34;aspectRatio&#34;</span>: <span style=color:#4070a0>&#34;1.85:1&#34;</span>},
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;cuts&#34;</span>: [
</span></span><span style=display:flex><span>    {<span style=color:#062873;font-weight:700>&#34;name&#34;</span>: <span style=color:#4070a0>&#34;Theatrical&#34;</span>, <span style=color:#062873;font-weight:700>&#34;runtime&#34;</span>: <span style=color:#40a070>138</span>},
</span></span><span style=display:flex><span>    {<span style=color:#062873;font-weight:700>&#34;name&#34;</span>: <span style=color:#4070a0>&#34;Special Edition&#34;</span>, <span style=color:#062873;font-weight:700>&#34;runtime&#34;</span>: <span style=color:#40a070>155</span>}],
</span></span><span style=display:flex><span>  <span style=color:#062873;font-weight:700>&#34;audio&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#4070a0>&#34;DTS HD&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#4070a0>&#34;Dolby Surround&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=constraints>Constraints</h3><p>Enforcing Data Integrity With JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>ALTER</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TABLE</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ADD</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>CONSTRAINT</span><span style=color:#bbb> </span>check_attr<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#007020;font-weight:700>CHECK</span><span style=color:#bbb> </span>(<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>!=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>or</span><span style=color:#bbb> </span>(<span style=color:#007020;font-weight:700>type</span><span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;M&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_TYPE(JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video&#39;</span>))<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;OBJECT&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_TYPE(JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.cuts&#39;</span>))<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;ARRAY&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_TYPE(JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.audio&#39;</span>))<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;ARRAY&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_TYPE(JSON_VALUE(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.disks&#39;</span>))<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;INTEGER&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_EXISTS(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video.resolution&#39;</span>)<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_EXISTS(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.video.aspectRatio&#39;</span>)<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_LENGTH(JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.cuts&#39;</span>))<span style=color:#bbb> </span><span style=color:#666>&gt;</span><span style=color:#bbb> </span><span style=color:#40a070>0</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>and</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>JSON_LENGTH(JSON_QUERY(attr,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;$.audio&#39;</span>))<span style=color:#bbb> </span><span style=color:#666>&gt;</span><span style=color:#bbb> </span><span style=color:#40a070>0</span>));<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=constraints-1>Constraints</h3><p>Enforcing Data Integrity With JSON Documents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span>(<span style=color:#007020;font-weight:700>type</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span>attr)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>(<span style=color:#4070a0>&#39;M&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Tron&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Blu-ray&#39;</span>,<span style=color:#bbb> </span><span style=color:#40a070>29</span>.<span style=color:#40a070>99</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;{&#34;video&#34;: {&#34;aspectRatio&#34;: &#34;2.21:1&#34;}, &#34;cuts&#34;: 
</span></span></span><span style=display:flex><span><span style=color:#4070a0>[{&#34;name&#34;: &#34;Theatrical&#34;, 
</span></span></span><span style=display:flex><span><span style=color:#4070a0>  &#34;runtime&#34;: 96}], &#34;audio&#34;: [&#34;DTS HD&#34;, &#34;Dolby Digital&#34;], &#34;disks&#34;: 1}&#39;</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>ERROR<span style=color:#bbb> </span><span style=color:#40a070>4025</span><span style=color:#bbb> </span>(<span style=color:#40a070>23000</span>):<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>CONSTRAINT</span><span style=color:#bbb> </span><span style=color:#666>`</span>check_attr<span style=color:#666>`</span><span style=color:#bbb> </span>failed<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>for</span><span style=color:#bbb> </span><span style=color:#666>`</span>test<span style=color:#666>`</span>.<span style=color:#666>`</span>products<span style=color:#666>`</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>NO RESOLUTION FIELD!</p><h3 id=constraints-2>Constraints</h3><h4 id=enforcing-data-integrity-with-json-documents>Enforcing Data Integrity With JSON Documents</h4><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>products<span style=color:#bbb> </span>(<span style=color:#007020;font-weight:700>type</span>,<span style=color:#bbb> </span>name,<span style=color:#bbb> </span>format,<span style=color:#bbb> </span>price,<span style=color:#bbb> </span>attr)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>(<span style=color:#4070a0>&#39;M&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Tron&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;Blu-ray&#39;</span>,<span style=color:#bbb> </span><span style=color:#40a070>29</span>.<span style=color:#40a070>99</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;{&#34;video&#34;: {&#34;resolution&#34;: &#34;1080p&#34;, &#34;aspectRatio&#34;: &#34;2.21:1&#34;}, &#34;cuts&#34;: 
</span></span></span><span style=display:flex><span><span style=color:#4070a0>  [{&#34;name&#34;: &#34;Theatrical&#34;, &#34;runtime&#34;: 96}], &#34;audio&#34;: [&#34;DTS HD&#34;, &#34;Dolby Digital&#34;], &#34;disks&#34;: &#34;one&#34;}&#39;</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><p><code>ERROR 4038 (HY000): Syntax error in JSON text in argument 1 to function 'json_type' at position 1</code></p><p>“ONE” IS NOT A NUMBER!</p><h2 id=accessing-mariadb-with-apis>Accessing MariaDB with APIs</h2><h3 id=application-program-interface-api>Application program interface (API)</h3><p>Database API allows an Application Server to interface easily with a MariaDB Server:</p><ul><li>Standardised communication interface</li><li>Serves as bottom-most layer in the communications tack on top of which SQL runs</li></ul><p>End Users → Web Page → Application Server → Database Server</p><p>Browser App → Backend / API → MariaDB</p><h3 id=minimal-steps-for-an-application>Minimal steps for an application</h3><p><strong>Preparation</strong></p><ul><li>Install and configure API software on server</li><li>Create a MariaDB user account for application</li></ul><p><strong>Basic components of application</strong></p><ul><li>Establish a connection to server</li><li>Query the database</li><li>Parse the data and display to user</li></ul><h3 id=api-database-user-account>Api database user account</h3><h4 id=create-user-account-for-api>Create User Account for API</h4><p>Set Host to Localhost</p><p>Limit Privileges (e.g., Only <code>SELECT</code>)</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>USER</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;api_user&#39;</span><span style=color:#666>@</span><span style=color:#4070a0>&#39;localhost&#39;</span><span style=color:#bbb> </span>IDENTIFIED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;mariadb&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>GRANT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span>api.<span style=color:#666>*</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TO</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;api_user&#39;</span><span style=color:#666>@</span><span style=color:#4070a0>&#39;localhost&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=installing-and-configuring---java>Installing and configuring - Java</h3><p>Connector/J is the standard connector for Java</p><p>Built on top of JDBC</p><p>Available from MariaDB web site as binary download (compiled classes in JAR)</p><p>Just place the JAR somewhere in your CLASSPATH</p><h3 id=connecting-to-mariadb---java>Connecting to MariaDB - Java</h3><p>Connect a Java Application to MariaDB</p><ul><li>Import required packages</li><li>Authentication Variables</li><li>New Connection Variable</li><li>Error Handling via try… catch (throws SQLException)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>java.sql.Connection</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>java.sql.DriverManager</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>import</span><span style=color:#bbb> </span>java.<span style=color:#4070a0>sql</span>.<span style=color:#4070a0>SQLException</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>String<span style=color:#bbb> </span>host<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span>&#39;</span>localhost<span>&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>String<span style=color:#bbb> </span>user<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span>&#39;</span>api_user<span>&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>String<span style=color:#bbb> </span>pw<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span>&#39;</span>mariadb<span>&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>String<span style=color:#bbb> </span>db<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span>&#39;</span>api<span>&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Connection<span style=color:#bbb> </span>conn<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>DriverManager.<span style=color:#4070a0>getConnection</span>(<span style=color:#4070a0>&#34;jdbc:mysql://&#34;</span><span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#bbb> </span>host<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34;/&#34;</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span>db<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34;?&#34;</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34;user=&#34;</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span>user<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34;&amp;password=&#34;</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span>pw);<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=querying-mariadb---java>Querying MariaDB - Java</h3><p><strong>Import required packages</strong></p><p><strong>Query Server</strong></p><ul><li>Declare prepared statement</li><li>Init prepared statement</li><li>Bind variable to statement</li><li>Execute statement</li><li>Fetch Results (Loop through Results & Display)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>java.sql.PreparedStatement</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>java.sql.ResultSet</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>String<span style=color:#bbb> </span>sql<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34;SELECT common_name, saber_color
</span></span></span><span style=display:flex><span><span style=color:#4070a0>              FROM jedis
</span></span></span><span style=display:flex><span><span style=color:#4070a0>              WHERE LOWER(common_name) LIKE LOWER(?)&#34;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>PreparedStatement<span style=color:#bbb> </span>stmt<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>connect.<span style=color:#4070a0>prepareStatement</span>(sql);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>stmt.<span style=color:#4070a0>setString</span>(1,<span style=color:#bbb> </span><span style=color:#4070a0>&#34;some_value&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>stmt.<span style=color:#4070a0>executeQuery</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>ResultSet<span style=color:#bbb> </span>rs<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>stmt.<span style=color:#4070a0>getResultSet</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>while</span><span style=color:#bbb> </span>(rs.<span style=color:#4070a0>next</span>())<span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>System.<span style=color:#4070a0>out</span>.<span style=color:#4070a0>println</span>(rs.<span style=color:#4070a0>getString</span>(<span style=color:#4070a0>&#34;common_name&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#4070a0>&#34; - &#34;</span><span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span>rs.<span style=color:#4070a0>getString</span>(<span style=color:#4070a0>&#34;saber_color&#34;</span>))<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=installing-and-configuring---r2dbc>Installing and configuring - R2DBC</h3><p>Standard connector for Java using the Reactive Relational Database Connectivity (R2DBC) API</p><p>R2DBC operations are non-blocking, which makes the R2DBC API more scalable than Java’s standard JDBC API.</p><p>Capable of being used with a native R2DBC implementation or in combination with an R2DBC Client Library (e.g. Spring Data R2DBC).</p><p>Get it from MariaDB web site as binary download (compiled classes in JAR)</p><p>Just place the JAR somewhere in your <code>CLASSPATH</code></p><p>The R2DBC specification is currently pre-GA and is planned to be released GA (v 1.0) by end of 2021.</p><h3 id=connecting-to-mariadb---r2dbc>Connecting to MariaDB - R2DBC</h3><p>Connect an R2DBC application to MariaDB</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>org.mariadb.r2dbc.MariadbConnectionConfiguration</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>org.mariadb.r2dbc.MariadbConnectionFactory</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>io.r2dbc.spi.Connection</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>MariadbConnectionConfiguration<span style=color:#bbb> </span>conf<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>MariadbConnectionConfiguration.<span style=color:#4070a0>builder</span>()<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:#4070a0>host</span>(<span style=color:#4070a0>&#34;192.0.2.1&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:#4070a0>port</span>(3306)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:#4070a0>username</span>(<span style=color:#4070a0>&#34;connr2dbc_test&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:#4070a0>password</span>(<span style=color:#4070a0>&#34;passwd&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:#4070a0>database</span>(<span style=color:#4070a0>&#34;test&#34;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>.<span style=color:#4070a0>build</span>();<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>MariadbConnectionFactory<span style=color:#bbb> </span>connFactory<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>new</span><span style=color:#bbb> </span>MariadbConnectionFactory(conf);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Connection<span style=color:#bbb> </span>conn<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>connFactory.<span style=color:#4070a0>create</span>().<span style=color:#4070a0>block</span>();<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=querying-mariadb---r2dbc>Querying MariaDB - R2DBC</h3><h4 id=import-required-packages-from-r2dbc>Import required packages from R2DBC</h4><h4 id=query-server>Query Server</h4><ul><li>Declare a statement</li><li>Execute the statement and map back the result to an iterator</li><li>Define the action inside the iterator</li><li>Define the action outside the iterator</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>io.r2dbc.spi.Statement</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>io.r2dbc.spi.Result</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>io.r2dbc.spi.Row</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>io.r2dbc.spi.RowMetadata</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>import</span><span style=color:#bbb> </span><span style=color:#0e84b5;font-weight:700>reactor.core.publisher.Flux</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Statement<span style=color:#bbb> </span>stmt<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>conn.<span style=color:#4070a0>createStatement</span>(<span style=color:#4070a0>&#34;SELECT name, email FROM contacts&#34;</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>for</span><span style=color:#bbb> </span>(String<span style=color:#bbb> </span>contact_entry<span style=color:#bbb> </span>:<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>Flux.<span style=color:#4070a0>from</span>(stmt.<span style=color:#4070a0>execute</span>()).<span style=color:#4070a0>flatMap</span>(<span style=color:#bbb> </span>res<span style=color:#bbb> </span><span style=color:#666>-&gt;</span><span style=color:#bbb> </span>res.<span style=color:#4070a0>map</span>(<span style=color:#bbb> </span>(row,<span style=color:#bbb> </span>metadata)<span style=color:#bbb> </span><span style=color:#666>-&gt;</span><span style=color:#bbb> </span>{<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:#007020;font-weight:700>return</span><span style=color:#bbb> </span>String.<span style=color:#4070a0>format</span>(<span style=color:#4070a0>&#34;%s: %s&#34;</span>,<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>row.<span style=color:#4070a0>get</span>(0,<span style=color:#bbb> </span>String.<span style=color:#4070a0>class</span>),<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>row.<span style=color:#4070a0>get</span>(1,<span style=color:#bbb> </span>String.<span style=color:#4070a0>class</span>)<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>))).<span style=color:#4070a0>toIterable</span>())<span style=color:#bbb> </span>{<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>System.<span style=color:#4070a0>out</span>.<span style=color:#4070a0>println</span>(contact_entry);<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=installing-and-configuring---nodejs>Installing and configuring - Node.js</h3><ul><li>Multiple legacy connectors exists like <code>mysql</code> and <code>mysql2</code></li><li>MariaDB provides its own connector <code>mariadb</code><ul><li>Higher performance</li><li>Modern API (promise) and legacy support (callbacks)</li></ul></li><li>Available in NPM<ul><li><code># npm install mariadb</code></li></ul></li></ul><h3 id=connecting-to-mariadb---nodejs>Connecting to MariaDB - Node.js</h3><p>Connect a Node.js Program to MariaDB</p><ul><li>Include the mariadb module</li><li>Authentication Variables</li><li>New Connection Variable</li><li>Error Handling</li><li>Disconnecting</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#007020;font-weight:700>const</span> mariadb <span style=color:#666>=</span> require(<span style=color:#4070a0>&#39;mariadb&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>const</span> host <span style=color:#666>=</span> <span style=color:#4070a0>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>const</span> user <span style=color:#666>=</span> <span style=color:#4070a0>&#39;api_user&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>const</span> pw <span style=color:#666>=</span> <span style=color:#4070a0>&#39;mariadb&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>const</span> db <span style=color:#666>=</span> <span style=color:#4070a0>&#39;api&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>var</span> conn <span style=color:#666>=</span> mariadb.createConnection({host<span style=color:#666>:</span> host, user<span style=color:#666>:</span> user, password<span style=color:#666>:</span> pw, database<span style=color:#666>:</span> db})
</span></span><span style=display:flex><span>  .<span style=color:#007020;font-weight:700>catch</span>(err =&gt; {
</span></span><span style=display:flex><span>    console.log(err);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>conn.end();
</span></span></code></pre></div><h3 id=querying-mariadb---nodejs>Querying MariaDB - Node.js</h3><p>Declare a SQL statement</p><p>Query Server</p><ul><li>Use the Promise interface</li><li>Fetch Results</li><li>Handle potential errors</li></ul><p>Close Statement Handle and Connection</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#007020;font-weight:700>const</span> sql <span style=color:#666>=</span> <span style=color:#4070a0>&#34;SELECT common_name, saber_color
</span></span></span><span style=display:flex><span><span style=color:#4070a0>             FROM jedis
</span></span></span><span style=display:flex><span><span style=color:#4070a0>             WHERE LOWER(common_name) LIKE LOWER(&#39;%some_value%&#39;)&#34;</span>;
</span></span><span style=display:flex><span>             
</span></span><span style=display:flex><span>conn.query(sql)
</span></span><span style=display:flex><span>.then(row =&gt; {
</span></span><span style=display:flex><span>    console.log(row[<span style=color:#40a070>0</span>].common_name <span style=color:#666>+</span> <span style=color:#4070a0>&#39; - &#39;</span> <span style=color:#666>+</span> row[<span style=color:#40a070>0</span>].saber_color);
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>.<span style=color:#007020;font-weight:700>catch</span>(err =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#60a0b0;font-style:italic>//handle connection error
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span>});
</span></span><span style=display:flex><span>.<span style=color:#007020;font-weight:700>finally</span>(() =&gt; {
</span></span><span style=display:flex><span>    conn.end();
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=installing-and-configuring---python>Installing and configuring - Python</h3><p>Native connector for MariaDB exists under the name <code>mariadb</code></p><p>Open-source project, created and maintained by the community</p><p>Available in the Python Package Index (PyPI) repository</p><p><code># pip install mariadb</code></p><h3 id=connecting-to-mariadb---python>Connecting to MariaDB - Python</h3><p>Connect a Python Program to MariaDB</p><ul><li>Import the mariadb module</li><li>Set the connection parameters</li><li>Errors will generate exceptions, so use try/catch to handle any of them</li><li>Get a connection cursor to run your queries</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>mariadb</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># Connect to MariaDB Platform</span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>try</span>:
</span></span><span style=display:flex><span>    conn <span style=color:#666>=</span> mariadb<span style=color:#666>.</span>connect(user<span style=color:#666>=</span><span style=color:#4070a0>&#34;db_user&#34;</span>, password<span style=color:#666>=</span><span style=color:#4070a0>&#34;db_user_passwd&#34;</span>, host<span style=color:#666>=</span><span style=color:#4070a0>&#34;192.0.2.1&#34;</span>, port<span style=color:#666>=</span><span style=color:#40a070>3306</span>, database<span style=color:#666>=</span><span style=color:#4070a0>&#34;employees&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>except</span> mariadb<span style=color:#666>.</span>Error <span style=color:#007020;font-weight:700>as</span> e:
</span></span><span style=display:flex><span>    <span style=color:#007020>print</span>(<span style=color:#4070a0>f</span><span style=color:#4070a0>&#34;Error connecting to MariaDB Platform: </span><span style=color:#70a0d0>{</span>e<span style=color:#70a0d0>}</span><span style=color:#4070a0>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># Get Cursor</span>
</span></span><span style=display:flex><span>cur <span style=color:#666>=</span> conn<span style=color:#666>.</span>cursor()
</span></span></code></pre></div><h3 id=querying-mariadb---python>Querying MariaDB - Python</h3><p>Queries are run through a cursor</p><p>Statements will be prepared on-the-fly</p><p>AUTOCOMMIT is on by default</p><p>Connection should be closed when not needed any more</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># Get data</span>
</span></span><span style=display:flex><span>some_name <span style=color:#666>=</span> <span style=color:#4070a0>&#34;George&#34;</span>
</span></span><span style=display:flex><span>cur<span style=color:#666>.</span>execute(<span style=color:#4070a0>&#34;SELECT first_name, last_name FROM employees WHERE first_name=?&#34;</span>, (some_name,))
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>for</span> first_name, last_name <span style=color:#007020;font-weight:700>in</span> cur:
</span></span><span style=display:flex><span>    <span style=color:#007020>print</span>(<span style=color:#4070a0>f</span><span style=color:#4070a0>&#34;First name: </span><span style=color:#70a0d0>{</span>first_name<span style=color:#70a0d0>}</span><span style=color:#4070a0>, Last name: </span><span style=color:#70a0d0>{</span>last_name<span style=color:#70a0d0>}</span><span style=color:#4070a0>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># Add data</span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>try</span>:
</span></span><span style=display:flex><span>    cur<span style=color:#666>.</span>execute(<span style=color:#4070a0>&#34;INSERT INTO employees (first_name, last_name) VALUES (?, ?)&#34;</span>, (<span style=color:#4070a0>&#34;Maria&#34;</span>,<span style=color:#4070a0>&#34;DB&#34;</span>))
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>except</span> mariadb<span style=color:#666>.</span>Error <span style=color:#007020;font-weight:700>as</span> e:
</span></span><span style=display:flex><span>    <span style=color:#007020>print</span>(<span style=color:#4070a0>f</span><span style=color:#4070a0>&#34;Error: </span><span style=color:#70a0d0>{</span>e<span style=color:#70a0d0>}</span><span style=color:#4070a0>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># Close connection</span>
</span></span><span style=display:flex><span>conn<span style=color:#666>.</span>close()
</span></span></code></pre></div><h3 id=installing-and-configuring---c>Installing and configuring - C++</h3><p>MariaDB Connector/C++ is a native C++ driver that can be used within C++ projects</p><p>The standard C client library can also be used in C++ projects</p><p>MariaDB Connector/C++ can be downloaded and installed for use on Linux and Windows</p><p>For more information on getting started with Connector/C++ see the official documentation -<br><a href=https://mariadb.com/docs/clients/connector-cpp/#connector-cpp-installation>https://mariadb.com/docs/clients/connector-cpp/#connector-cpp-installation</a></p><h3 id=connecting-to-mariadb---c>Connecting to MariaDB - C++</h3><p>Connect a C++ Program to MariaDB Connector/C++</p><ul><li>Including required headers</li><li>Defining connection properties</li><li>Creating an account</li><li>Connecting to the database</li><li>Disconnecting</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#007020>#include</span> <span style=color:#007020>&lt;mariadb/conncpp.hpp&gt;</span><span style=color:#007020>
</span></span></span><span style=display:flex><span><span style=color:#007020></span>
</span></span><span style=display:flex><span>sql<span style=color:#666>::</span>Driver<span style=color:#666>*</span> driver <span style=color:#666>=</span> 
</span></span><span style=display:flex><span>    sql<span style=color:#666>::</span>mariadb<span style=color:#666>::</span>get_driver_instance();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sql<span style=color:#666>::</span>SQLString
</span></span><span style=display:flex><span>url(<span style=color:#4070a0>&#34;jdbc:mariadb://192.0.2.1:3306/employees&#34;</span>)
</span></span><span style=display:flex><span>sql<span style=color:#666>::</span>Properties properties({{<span style=color:#4070a0>&#34;user&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#4070a0>&#34;db_user&#34;</span>}, {<span style=color:#4070a0>&#34;password&#34;</span>, <span style=color:#4070a0>&#34;db_user_password&#34;</span>}});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>std<span style=color:#666>::</span>unique_ptr<span style=color:#666>&lt;</span>sql<span style=color:#666>::</span>Connection<span style=color:#666>&gt;</span>
</span></span><span style=display:flex><span>    conn(driver<span style=color:#666>-&gt;</span>connect(url, properties));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>conn<span style=color:#666>-&gt;</span>close();
</span></span></code></pre></div><h3 id=querying-mariadb---c>Querying MariaDB - C++</h3><h4 id=query-server-1>Query Server</h4><p>Include required headers</p><p>Define a prepared statement</p><p>Prepare the statement</p><p>Bind variables</p><p>Execute the query and obtain result set</p><p>Loop over the result set to read it</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#007020>#include</span> <span style=color:#007020>&lt;mariadb/conncpp.hpp&gt;</span><span style=color:#007020>
</span></span></span><span style=display:flex><span><span style=color:#007020></span>
</span></span><span style=display:flex><span><span style=color:#007020>#define SQL &#34;SELECT common_name, saber_color FROM jedis WHERE LOWER(common_name) LIKE LOWER(?)&#34;
</span></span></span><span style=display:flex><span><span style=color:#007020></span>
</span></span><span style=display:flex><span>std<span style=color:#666>::</span>unique_ptr<span style=color:#666>&lt;</span>sql<span style=color:#666>::</span>Statement<span style=color:#666>&gt;</span> stmt(conn<span style=color:#666>-&gt;</span>createStatement());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stmt<span style=color:#666>-&gt;</span>setString(<span style=color:#40a070>1</span>, <span style=color:#4070a0>&#34;some_value&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sql<span style=color:#666>::</span>ResultSet<span style=color:#666>*</span> res <span style=color:#666>=</span> stmt<span style=color:#666>-&gt;</span>executeQuery(<span style=color:#4070a0>&#34;SELECT common_name, saber_color FROM jedis WHERE LOWER(common_name) LIKE LOWER(?)&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>while</span> (res<span style=color:#666>-&gt;</span>next()) {
</span></span><span style=display:flex><span>    cout <span style=color:#666>&lt;&lt;</span> res<span style=color:#666>-&gt;</span>getString(<span style=color:#40a070>0</span>);
</span></span><span style=display:flex><span>    cout <span style=color:#666>&lt;&lt;</span> res<span style=color:#666>-&gt;</span>getString(<span style=color:#40a070>1</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=installing-and-configuring---c-1>Installing and configuring - C</h3><p>MariaDB provides a client shared object library with header files</p><p>Use <code>yum</code> or similar to install the development package:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># yum install MariaDB-devel</span>
</span></span></code></pre></div><p>Alternatively, if you compile MariaDB from source, client library and headers will be installed locally</p><h3 id=connecting-to-mariadb---c-1>Connecting to MariaDB - C</h3><p>Connect a C Programme to MariaDB</p><p>Including the required header<br>Defining connection properties<br>Creating a new connection handler<br>Connecting to server<br>Handling errors<br>Disconnecting from server</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#007020>#include</span> <span style=color:#007020>&lt;mysql.h&gt;</span><span style=color:#007020>
</span></span></span><span style=display:flex><span><span style=color:#007020></span>
</span></span><span style=display:flex><span><span style=color:#007020>#define HOST &#34;localhost&#34;
</span></span></span><span style=display:flex><span><span style=color:#007020>#define USER &#34;api_user&#34;
</span></span></span><span style=display:flex><span><span style=color:#007020>#define PW &#34;mariadb&#34;
</span></span></span><span style=display:flex><span><span style=color:#007020>#define DB &#34;api&#34;
</span></span></span><span style=display:flex><span><span style=color:#007020></span>
</span></span><span style=display:flex><span>MYSQL <span style=color:#666>*</span>conn <span style=color:#666>=</span> <span style=color:#06287e>mysql_init</span>(<span style=color:#007020>NULL</span>);
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>if</span> (<span style=color:#666>!</span><span style=color:#06287e>mysql_real_connect</span>(conn, HOST, USER, PW, DB, <span style=color:#40a070>3306</span>, <span style=color:#007020>NULL</span>, <span style=color:#40a070>0</span>))
</span></span><span style=display:flex><span>    <span style=color:#06287e>printf</span>(<span style=color:#4070a0>&#34;%s</span><span style=color:#4070a0;font-weight:700>\n</span><span style=color:#4070a0>&#34;</span>, <span style=color:#06287e>mysql_error</span>(conn));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#06287e>mysql_close</span>(conn);
</span></span></code></pre></div><h3 id=querying-mariadb---c-1>Querying MariaDB - C</h3><p>Define a SQL query</p><p>Query Server</p><ul><li>Execute the query</li><li>Retrieve a result set</li><li>Iterate over the result set to read values</li></ul><p>Free resources</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#007020>#define SQL &#34;SELECT common_name, saber_color FROM jedis WHERE LOWER(common_name) LIKE LOWER(&#39;some_value&#39;)&#34;
</span></span></span><span style=display:flex><span><span style=color:#007020></span>
</span></span><span style=display:flex><span><span style=color:#06287e>mysql_query</span>(conn, sql);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MYSQL_RES <span style=color:#666>*</span>rs <span style=color:#666>=</span> <span style=color:#06287e>mysql_store_result</span>(conn);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>while</span> (MYSQL_ROW row <span style=color:#666>=</span> <span style=color:#06287e>mysql_fetch_row</span>(rs))
</span></span><span style=display:flex><span>    <span style=color:#06287e>printf</span>(<span style=color:#4070a0>&#34;%s = %s</span><span style=color:#4070a0;font-weight:700>\n</span><span style=color:#4070a0>&#34;</span>, row[<span style=color:#40a070>0</span>], row[<span style=color:#40a070>1</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#06287e>mysql_free_result</span>(rs);
</span></span></code></pre></div><h2 id=non-native-mariadb-connectors>Non-native MariaDB connectors</h2><h3 id=installing-and-configuring---net>Installing and configuring - .NET</h3><p>Multiple connectors exist, both free to use and commercial ones.</p><p>MySql Connector is a truly async MySQL ADO.NET provider, supporting MariaDB</p><p>It has a permissive license (MIT)</p><p>It is available from the NuGet repository</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>C:<span style=color:#4070a0;font-weight:700>\&gt;</span> Install-Package MySqlConnector -Version 1.3.8
</span></span></code></pre></div><h3 id=connecting-to-mariadb---net>Connecting to MariaDB - .NET</h3><p>Connect a .NET Program to MariaDB</p><ul><li>Define the necessary connection properties and pass them to a new instance of the connection</li><li>Open the connection</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#007020;font-weight:700>using</span> (<span style=color:#902000>var</span> connection = <span style=color:#007020;font-weight:700>new</span> MySqlConnection(<span style=color:#4070a0>&#34;Server=myserver;User ID=mylogin;Password=mypass;Database=mydatabase&#34;</span>))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    connection.Open();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=querying-mariadb---net>Querying MariaDB - .NET</h3><p>Use an existing connection.</p><p>Define the query string as a new instance of the MySqlCommand class.</p><p>Pass this new instance to the connection and it will execute it.</p><p>Get back a reader from the command class.</p><p>Loop around the reader to fetch the result set row by row.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#007020;font-weight:700>using</span> (<span style=color:#902000>var</span> connection = <span style=color:#007020;font-weight:700>new</span> MySqlConnection(<span style=color:#4070a0>&#34;Server=myserver;User ID=mylogin;Password=mypass;Database=mydatabase&#34;</span>))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    connection.Open();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#007020;font-weight:700>using</span> (<span style=color:#902000>var</span> command = <span style=color:#007020;font-weight:700>new</span> MySqlCommand(<span style=color:#4070a0>&#34;SELECT field FROM table;&#34;</span>, connection))
</span></span><span style=display:flex><span>    <span style=color:#007020;font-weight:700>using</span> (<span style=color:#902000>var</span> reader = command.ExecuteReader())
</span></span><span style=display:flex><span>    <span style=color:#007020;font-weight:700>while</span> (reader.Read())
</span></span><span style=display:flex><span>    Console.WriteLine(reader.GetString(<span style=color:#40a070>0</span>));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=installing-and-configuring---php>Installing and configuring - PHP</h3><p>Three PHP APIs (<em>mysql</em>, <em>mysqli</em>, and PDO Extensions)</p><ul><li>MySQL Improved (<em>mysqli</em>) is Recommended</li></ul><p>Use <code>yum</code> or similar Utility to Install PHP and <em>mysqli</em></p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># yum install php php-mysql</span>
</span></span></code></pre></div><p>The web server should be configured to render PHP pages properly; if PHP is installed from a distribution package, this is usually included in the package.</p><h3 id=connecting-to-mariadb---php>Connecting to MariaDB - PHP</h3><p>Connect a Web Page or Program to MariaDB</p><ul><li>PHP Tags</li><li>Authentication Variables</li><li>New Connection Variable</li><li>Error Handling</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#666>&lt;?</span>php
</span></span><span style=display:flex><span><span style=color:#bb60d5>$host</span> <span style=color:#666>=</span> <span style=color:#4070a0>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#bb60d5>$user</span> <span style=color:#666>=</span> <span style=color:#4070a0>&#39;api_user&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#bb60d5>$pw</span> <span style=color:#666>=</span> <span style=color:#4070a0>&#39;mariadb&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#bb60d5>$db</span> <span style=color:#666>=</span> <span style=color:#4070a0>&#39;api&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#bb60d5>$connect</span> <span style=color:#666>=</span> <span style=color:#007020;font-weight:700>new</span> mysqli(<span style=color:#bb60d5>$host</span>, <span style=color:#bb60d5>$user</span>, <span style=color:#bb60d5>$pw</span>, <span style=color:#bb60d5>$db</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>if</span> (mysqli_connect_errno()) {
</span></span><span style=display:flex><span>    printf(<span style=color:#4070a0>&#34;Connect failed: %s</span><span style=color:#4070a0;font-weight:700>\n</span><span style=color:#4070a0>&#34;</span>,
</span></span><span style=display:flex><span>    mysqli_connect_error());
</span></span><span style=display:flex><span>    <span style=color:#007020;font-weight:700>exit</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#007020>?&gt;</span><span>
</span></span></span></code></pre></div><h3 id=querying-mariadb---php>Querying MariaDB - PHP</h3><ul><li><p><strong>Capture & Parse User Input</strong></p></li><li><p><strong>Query Server</strong></p><ul><li>Store SQL Statement with Placeholder</li><li>Prepare Connection with SQL Statement</li><li>Prepare Variables to Store Fields from Results</li><li>Fetch Results (Loop through Results & Display)</li></ul></li><li><p><strong>Close Statement Handle and Connection</strong></p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#666>&lt;?</span>php
</span></span><span style=display:flex><span><span style=color:#bb60d5>$search_parameter</span> <span style=color:#666>=</span> <span style=color:#bb60d5>$_REQUEST</span>[<span style=color:#4070a0>&#39;jediname&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#bb60d5>$search_parameter</span> <span style=color:#666>=</span> <span style=color:#4070a0>&#34;%&#34;</span> <span style=color:#666>.</span> <span style=color:#bb60d5>$search_parameter</span> <span style=color:#666>.</span> <span style=color:#4070a0>&#34;%&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#bb60d5>$sql</span> <span style=color:#666>=</span> <span style=color:#4070a0>&#34;SELECT common_name, saber_color
</span></span></span><span style=display:flex><span><span style=color:#4070a0>        FROM jedis
</span></span></span><span style=display:flex><span><span style=color:#4070a0>         WHERE LOWER(common_name) LIKE LOWER(?)&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#bb60d5>$sth</span> <span style=color:#666>=</span> <span style=color:#bb60d5>$connect</span><span style=color:#666>-&gt;</span><span style=color:#4070a0>prepare</span>(<span style=color:#bb60d5>$sql</span>);
</span></span><span style=display:flex><span><span style=color:#bb60d5>$sth</span><span style=color:#666>-&gt;</span><span style=color:#4070a0>bind_param</span>(<span style=color:#4070a0>&#39;s&#39;</span>, <span style=color:#bb60d5>$search_parameter</span>);
</span></span><span style=display:flex><span><span style=color:#bb60d5>$sth</span><span style=color:#666>-&gt;</span><span style=color:#4070a0>execute</span>();
</span></span><span style=display:flex><span><span style=color:#bb60d5>$sth</span><span style=color:#666>-&gt;</span><span style=color:#4070a0>bind_result</span>(<span style=color:#bb60d5>$common</span>, <span style=color:#bb60d5>$saber_color</span>);
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>while</span>(<span style=color:#bb60d5>$sth</span><span style=color:#666>-&gt;</span><span style=color:#4070a0>fetch</span>()) {
</span></span><span style=display:flex><span>     <span style=color:#007020;font-weight:700>print</span> <span style=color:#4070a0>&#34;</span><span style=color:#70a0d0>$common</span><span style=color:#4070a0> - &lt;i&gt;</span><span style=color:#70a0d0>$saber_color</span><span style=color:#4070a0>&lt;/i&gt;&lt;br/&gt;&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#bb60d5>$sth</span><span style=color:#666>-&gt;</span><span style=color:#4070a0>close</span>();
</span></span><span style=display:flex><span><span style=color:#bb60d5>$connect</span><span style=color:#666>-&gt;</span><span style=color:#4070a0>close</span>();
</span></span><span style=display:flex><span><span style=color:#007020>?&gt;</span><span>
</span></span></span></code></pre></div><h3 id=other-database-connectors>Other database connectors</h3><p>Many other programming languages provide their own connectors for MariaDB Server</p><p>Some could be native, others are often based on the MariaDB client shared library</p><ul><li>For Perl, look at the <code>DBD::MySQL</code> module, available in CPAN.</li><li>For Ruby, there is a package available in the Rubygem repository.</li><li>For R, use the <code>RMariaDB</code> package.</li><li>For Erlang, there is a native implementation named <code>MySQL/OTP</code> which can be used with MariaDB Server.</li><li>For dotNet, there are commercially supported connectors from various vendors which may offer advanced features, compared to the open-source one.</li></ul><h3 id=object-relational-mapping-orm>Object-relational mapping (ORM)</h3><p>Object-Relational Mapping (ORM) is technique that lets you query and manipulate data from a database using an object-oriented paradigm.</p><p>There are many ORM libraries/frameworks that exist across a variety of languages. A few examples that have been tested to work with native MariaDB connectors are:</p><ul><li>Python: SQLAlchemy</li><li>Java: Hibernate, jOOQ, JPA</li><li>Node.js: Sequelize</li></ul><p>Before incorporating an ORM into a project, make sure you understand how it works with the database and how this relates to your projected workload.</p><h2 id=error-and-warning-handling>Error and warning handling</h2><h3 id=sql-errors-and-warnings>SQL errors and warnings</h3><p><strong>SHOW WARNINGS</strong> Statement returns errors, warnings, and notes</p><p>Relevant to the last statement that used a table</p><p>Each new <strong>INSERT</strong> that uses a table clears the list first</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TABLE</span><span style=color:#bbb> </span>table1<span style=color:#bbb> </span>(col1<span style=color:#bbb> </span>TINYINT);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>table1<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> </span>(<span style=color:#40a070>1000</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Query<span style=color:#bbb> </span>OK,<span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>row</span><span style=color:#bbb> </span>affected,<span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb> </span>warning<span style=color:#bbb> </span>(<span style=color:#40a070>0</span>.<span style=color:#40a070>00</span><span style=color:#bbb> </span>sec)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SHOW</span><span style=color:#bbb> </span>WARNINGS;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------+------+----------------------------------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>Level</span><span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb> </span>Code<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Message<span style=color:#bbb>                                </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------+------+----------------------------------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Warning<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1264</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>Out</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>of</span><span style=color:#bbb> </span>range<span style=color:#bbb> </span>value<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>for</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>column</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;c1&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>at</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>row</span><span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------+------+----------------------------------------+
</span></span></span></code></pre></div><h3 id=operating-system-errors>Operating system errors</h3><p>Low level errors may affect MariaDB&rsquo;s operation</p><p>Things like low disk space, file system permissions, etc</p><p>OS level error codes are passed back up the chain</p><p>MariaDB includes the <code>perror</code> utility for displaying errors</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>LOAD</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>DATA</span><span style=color:#bbb> </span>INFILE<span style=color:#bbb> </span><span style=color:#4070a0>&#39;/root/test&#39;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TABLE</span><span style=color:#bbb> </span>t1;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>ERROR<span style=color:#bbb> </span><span style=color:#40a070>13</span><span style=color:#bbb> </span>(HY000):<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Can<span style=color:#4070a0>&#39;t get stat of &#39;</span><span style=color:#666>/</span>root<span style=color:#666>/</span>test<span style=color:#4070a0>&#39; (Errcode: 13)
</span></span></span><span style=display:flex><span><span style=color:#4070a0>
</span></span></span><span style=display:flex><span><span style=color:#4070a0># perror 13
</span></span></span><span style=display:flex><span><span style=color:#4070a0>Error code 13: Permission denied
</span></span></span></code></pre></div><h3 id=domain-name-service>Domain name service</h3><p>MariaDB uses DNS and Reverse DNS for IP and Hostname with Client Connections</p><p>A Slow DNS Server can Slow MariaDB Client Connection</p><p>Running a Local DNS Server Helps with Lookup Speed and Security</p><p>Use <code>--skip-name-resolve</code> to Tell MariaDB Not to do DNS Lookup<br>Then Use Only IP Addresses in Permissions Tables</p><h3 id=persistent-connections>Persistent connections</h3><p>Some Client Languages and Connection Pool Solutions use Persistent Connections (PHP <code>mysql_pconnect()</code>)</p><p>Not very Effective<br>A New Client Connection is Simpler</p><p>Client Session Buffers can Stay Allocated too Long if the Client Pool of Application is not Efficient, Increasing Memory Usage</p><p>Transactions can be Held Open if Application is Built Poorly, Reducing Concurrency</p><h3 id=avoiding-divide-by-zero>Avoiding divide by zero</h3><p>MariaDB Fails Silently and Produces a <code>NULL</code> Response for Divide-by-zero Error</p><ul><li>Unless SQL Mode <code>ERROR_FOR_DIVISION_BY_ZERO</code> is Active</li></ul><p>The <code>COALESCE</code> and <code>NULLIF</code> functions can be used to provide a solution for divide-by-zero errors:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span><span style=color:#666>@</span>INPUT1<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>0</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>COALESCE(<span style=color:#40a070>50</span><span style=color:#bbb> </span><span style=color:#666>/</span><span style=color:#007020;font-weight:700>NULLIF</span>(<span style=color:#666>@</span>INPUT1,<span style=color:#40a070>0</span>),<span style=color:#40a070>0</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>response;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>response<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>0</span>.<span style=color:#40a070>0000</span><span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>----------+
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span><span style=color:#666>@</span>INPUT1<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>5</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>COALESCE(<span style=color:#40a070>50</span><span style=color:#bbb> </span><span style=color:#666>/</span><span style=color:#007020;font-weight:700>NULLIF</span>(<span style=color:#666>@</span>INPUT1,<span style=color:#40a070>0</span>),<span style=color:#40a070>0</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>response;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>response<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>10</span>.<span style=color:#40a070>0000</span><span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>----------+
</span></span></span></code></pre></div><h2 id=lesson-summary>Lesson summary</h2><ul><li>Differentiate between stored procedures and stored functions using the native MariaDB SQL/PSM language</li><li>Use JSON document stores</li><li>Understand how to access MariaDB via APIs using both native and non-native MariaDB connectors</li><li>Set SQL modes to affect error output and use the <code>SHOW WARNINGS</code> and <code>SHOW ERRORS</code> statements to interpret error messages</li></ul><h2 id=lab-exercises>Lab exercises</h2><ul><li>7-1 Connecting to MariaDB with a PHP-Based Web Form</li><li>7-2 Connecting to MariaDB with a Python Script</li><li>7-3 Creating a View</li><li>7-4 Creating a Stored Procedure in SQL/PSM</li></ul><hr><p>For academic and non-commercial usage, licensed under CC BY-NC-SA 4.0 by MariaDB plc.</p></div><div class=right-menu><div class=quick-links><a href=https://github.com/MariaDB/mariadb-for-universities/blob/main/mariadb-dev-05-programming.md class="icon-link edit-page">View page source</a>
<a href=https://github.com/MariaDB/mariadb-for-universities/edit/main/mariadb-dev-05-programming.md class="icon-link view-source">Edit this page</a>
<a href="https://github.com/MariaDB/mariadb-for-universities/issues/new?title=Course%20Material%20issue%20for%20Lesson%205%3a%20Programming&body=I%20found%20an%20issue%20with%20the%20documentation%20for%20Lesson%205%3a%20Programming.%0A%0A%0A%0A---%0A%0AThis%20issue%20is%20related%20to%20the%20following%20page%3A%0A%0Ahttps%3a%2f%2funi.mariadb.org%2fdev%2fprogramming%2f" class="icon-link create-doc">Create material issue</a>
<a href=javascript:void(0) onclick=printSection() class="icon-link print">Print entire section</a></div></div></div><script>function printSection(){const e=document.querySelector(".left-menu"),t=document.querySelector(".right-menu"),n=e.style.display,s=t.style.display;e.style.display="none",t.style.display="none",window.print(),e.style.display=n,t.style.display=s}</script></body></html>