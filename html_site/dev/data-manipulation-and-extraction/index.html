<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>MariaDB for Universities Program: Course Material</title>
<link rel=stylesheet href=/css/main.css><meta property="og:url" content="https://uni.mariadb.org/dev/data-manipulation-and-extraction/"><meta property="og:site_name" content="MariaDB for Universities Program Course Material"><meta property="og:title" content="Lesson 4: Data manipulation and extraction"><meta property="og:description" content="Data manipulation and extraction Learning objectives Know how to select, insert, load, change and delete data Explain how to execute outer and inner joins, and join a table to itself Know how to use correct SQL syntax when creating subqueries within a statement, and demonstrate how to convert subqueries into joins Describe and use window functions and common table expressions (CTEs) Selecting data Select statement Retrieves data from the table for the client"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="dev"><meta property="article:published_time" content="2025-04-10T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-10T00:00:00+00:00"></head><body><div class=top-menu><div class=menu-left><a href=/ class=home-link>MariaDB for Universities Program: Course Material</a></div><div class=menu-right><a href=https://mariadb.org>MariaDB Foundation (mariadb.org)</a></div></div><div class=content-wrapper><div class=left-menu><div class=table-of-contents><h2><a href=.>Lesson 4: Data manipulation and extraction</a></h2><nav id=TableOfContents><ul><li><a href=#learning-objectives>Learning objectives</a></li><li><a href=#selecting-data>Selecting data</a><ul><li><a href=#select-statement>Select statement</a></li><li><a href=#where-clause>Where clause</a></li><li><a href=#operators>Operators</a></li><li><a href=#limit-clause>Limit clause</a></li><li><a href=#order-by-and-limit-clause>Order by and limit clause</a></li><li><a href=#ascending-and-descending-order>Ascending and descending order</a></li><li><a href=#group-by-clause>Group by clause</a></li><li><a href=#select-into-outfile-statement>Select into outfile statement</a></li></ul></li><li><a href=#inserting-and-loading-data>Inserting and loading data</a><ul><li><a href=#single-versus-multi-row-insert>Single versus multi-row insert</a></li><li><a href=#multi-row-insert-caveats>Multi-row insert caveats</a></li><li><a href=#insertselect-statement>Insert&mldr;select statement</a></li><li><a href=#duplicate-keys-statement>Duplicate keys statement</a></li><li><a href=#load-data-infile-statement>Load data infile statement</a></li><li><a href=#importing-sql-files>Importing SQL files</a></li></ul></li><li><a href=#changing-and-deleting-data>Changing and deleting data</a><ul><li><a href=#update-statement>Update statement</a></li><li><a href=#replace-statement>Replace statement</a></li><li><a href=#delete-statement>Delete statement</a></li><li><a href=#truncate-statement>Truncate statement</a></li></ul></li><li><a href=#joins>Joins</a><ul><li><a href=#joins-overview>Joins overview</a></li><li><a href=#implicit-join-syntax>Implicit join syntax</a></li><li><a href=#explicit-join-syntax>Explicit join syntax</a></li><li><a href=#inner-joins>Inner joins</a></li><li><a href=#outer-joins>Outer joins</a></li><li><a href=#outer-join-example>Outer join example</a></li><li><a href=#natural-joins>Natural joins</a></li><li><a href=#general-tips>General tips</a></li><li><a href=#general-tips-1>General tips</a></li><li><a href=#general-tips-2>General tips</a></li></ul></li><li><a href=#subqueries>Subqueries</a><ul><li><a href=#subqueries-1>Subqueries</a></li><li><a href=#scalar-subquery>Scalar subquery</a></li><li><a href=#row-subqueries>Row subqueries</a></li><li><a href=#table-subquery-result-set>Table subquery result set</a></li><li><a href=#rewriting-to-joins>Rewriting to joins</a></li><li><a href=#rewriting-to-joins-1>Rewriting to joins</a></li></ul></li><li><a href=#lesson-summary>Lesson summary</a></li><li><a href=#lab-exercises>Lab exercises</a></li></ul></nav></div></div><div class=main-content><nav class=breadcrumb><a href=/>MariaDB for Universities Course Material</a>
>
<a href=/dev/>MariaDB Developer Course</a>
> <span class=current>Lesson 4: Data manipulation and extraction</span></nav><h1>Lesson 4: Data manipulation and extraction</h1><h1 id=data-manipulation-and-extraction>Data manipulation and extraction</h1><h2 id=learning-objectives>Learning objectives</h2><ul><li>Know how to select, insert, load, change and delete data</li><li>Explain how to execute outer and inner joins, and join a table to itself</li><li>Know how to use correct <code>SQL</code> syntax when creating subqueries within a statement, and demonstrate how to convert subqueries into joins</li><li>Describe and use window functions and common table expressions (<code>CTEs</code>)</li></ul><h2 id=selecting-data>Selecting data</h2><h3 id=select-statement>Select statement</h3><p><strong>Retrieves data from the table for the client</strong></p><p><strong>Can calculate and use functions</strong></p><p>Be careful of the overuse of functions in OLTP use cases where it may be better to add a column such as a virtual column that contains calculations already rendered</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>CONCAT(name_first,<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SPACE</span>(<span style=color:#40a070>1</span>),<span style=color:#bbb> </span>name_last)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;Name&#39;</span>,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>(DAYOFYEAR(birthdate)<span style=color:#bbb> </span><span style=color:#666>-</span><span style=color:#bbb> </span>DAYOFYEAR(CURDATE()))<span style=color:#bbb> </span><span style=color:#666>/</span><span style=color:#bbb> </span><span style=color:#40a070>12</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;Months to Birthday&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>clients<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>LIMIT</span><span style=color:#bbb> </span><span style=color:#40a070>1</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><p>An Example of Retrieving Data, Calculating, and Using Functions with a <code>SELECT</code> Statement</p><h3 id=where-clause>Where clause</h3><p>Used with <code>SELECT</code>, <code>UPDATE</code>, and <code>DELETE</code> Statements</p><p>Columns with Operators can be Specified to Filter Results</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Name,<span style=color:#bbb> </span>Population<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>City<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>Population<span style=color:#bbb> </span><span style=color:#666>&gt;</span><span style=color:#bbb> </span><span style=color:#40a070>1000000</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------+------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>        </span><span style=color:#666>|</span><span style=color:#bbb> </span>Population<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------+------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Kabul<span style=color:#bbb>       </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1780000</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Alger<span style=color:#bbb>       </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>2168000</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Luanda<span style=color:#bbb>      </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>2022000</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Buenos<span style=color:#bbb> </span>Aires<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>2982146</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>La<span style=color:#bbb> </span>Matanza<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#40a070>1266461</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>...<span style=color:#bbb>         </span><span style=color:#666>|</span><span style=color:#bbb>            </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>Basic Example for <code>SELECT</code> Statement using <code>WHERE</code> Clause</p><h3 id=operators>Operators</h3><p>The <code>WHERE</code> Clause Allows For Several Operators</p><table><thead><tr><th>Arithmetic</th><th>Comparison</th></tr></thead><tbody><tr><td>-</td><td>AND, &&</td></tr><tr><td>+</td><td>OR, ||</td></tr><tr><td>*</td><td>XOR</td></tr><tr><td>/</td><td>>=</td></tr><tr><td>%</td><td>></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table><h3 id=limit-clause>Limit clause</h3><p>Used to limit the offset and number of rows returned</p><p>Values must be positive integer constants</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Name,<span style=color:#bbb> </span>District<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>City<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>CountryCode<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;FIN&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>LIMIT</span><span style=color:#bbb> </span><span style=color:#40a070>2</span>,<span style=color:#bbb> </span><span style=color:#40a070>3</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------------+-----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>              </span><span style=color:#666>|</span><span style=color:#bbb> </span>District<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------------+-----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Helsinki<span style=color:#bbb>          </span><span style=color:#666>|</span><span style=color:#bbb> </span>Newmaa<span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Espoo<span style=color:#bbb>             </span><span style=color:#666>|</span><span style=color:#bbb> </span>Newmaa<span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Tampere<span style=color:#bbb>           </span><span style=color:#666>|</span><span style=color:#bbb> </span>Pirkanmaa<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------------+-----------+
</span></span></span></code></pre></div><h3 id=order-by-and-limit-clause>Order by and limit clause</h3><p>Data can be Ordered and Broken into Blocks</p><p><code>SELECT cols</code>
<code>FROM table</code>
<code>WHERE clause</code>
<code>ORDER BY col</code>
<code>LIMIT offset, count;</code></p><p>Basic Syntax Example for <code>SELECT</code> Statement with <code>ORDER BY</code> Clause</p><p><code>SELECT Name, Population</code>
<code>FROM City</code>
<code>WHERE Population > 1000000</code>
<code>ORDER BY Population</code>
<code>LIMIT 0, 3;</code></p><table><thead><tr><th>Name</th><th>Population</th></tr></thead><tbody><tr><td>Zapopan</td><td>1,012,563</td></tr><tr><td>Napoli</td><td>1,002,079</td></tr><tr><td>Perm</td><td>1,070,162</td></tr></tbody></table><h3 id=ascending-and-descending-order>Ascending and descending order</h3><p>Add the <code>ASC</code> or <code>DESC</code> Options to Order Results in Ascending or Descending Order</p><p>Multiple Columns Allowed</p><p>No descending indexes however B+ Tree indexes can be used to optimize sort or range based queries</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Name,<span style=color:#bbb> </span>District<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>City<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>CountryCode<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;FIN&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>ORDER</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span>District<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>DESC</span>,<span style=color:#bbb> </span>Name<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ASC</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>           </span><span style=color:#666>|</span><span style=color:#bbb> </span>District<span style=color:#bbb>         </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#60a0b0;font-style:italic>----------------|------------------|
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Turku<span style=color:#bbb> </span>[<span>Å</span>bo]<span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb> </span>Varsinais<span style=color:#666>-</span>Suomi<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Lahti<span style=color:#bbb>          </span><span style=color:#666>|</span><span style=color:#bbb> </span>Päijät<span style=color:#666>-</span>Häme<span style=color:#bbb>      </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Oulu<span style=color:#bbb>           </span><span style=color:#666>|</span><span style=color:#bbb> </span>Pohjois<span style=color:#666>-</span>Pohjanmaa<span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Tampere<span style=color:#bbb>        </span><span style=color:#666>|</span><span style=color:#bbb> </span>Pirkanmaa<span style=color:#bbb>        </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Espoo<span style=color:#bbb>          </span><span style=color:#666>|</span><span style=color:#bbb> </span>Newmaa<span style=color:#bbb>           </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Helsinki<span style=color:#bbb> </span>[Helsingfors]<span style=color:#666>|</span><span style=color:#bbb> </span>Newmaa<span style=color:#bbb>     </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Vantaa<span style=color:#bbb>         </span><span style=color:#666>|</span><span style=color:#bbb> </span>Newmaa<span style=color:#bbb>           </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=group-by-clause>Group by clause</h3><p>Useful with Aggregate Functions to Create Sub-Groups</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Continent,<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SUM</span>(Population)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>Country<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>GROUP</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span>Continent;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------------+------------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Continent<span style=color:#bbb>     </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SUM</span>(Population)<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------------+------------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Asia<span style=color:#bbb>          </span><span style=color:#666>|</span><span style=color:#bbb>    </span><span style=color:#40a070>3750025700</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Europe<span style=color:#bbb>        </span><span style=color:#666>|</span><span style=color:#bbb>     </span><span style=color:#40a070>730074600</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>North<span style=color:#bbb> </span>America<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>     </span><span style=color:#40a070>482993000</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Africa<span style=color:#bbb>        </span><span style=color:#666>|</span><span style=color:#bbb>     </span><span style=color:#40a070>784475000</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Oceania<span style=color:#bbb>       </span><span style=color:#666>|</span><span style=color:#bbb>      </span><span style=color:#40a070>30401150</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Antarctica<span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>              </span><span style=color:#40a070>0</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>South<span style=color:#bbb> </span>America<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>     </span><span style=color:#40a070>345780000</span><span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------------+------------------+
</span></span></span></code></pre></div><h3 id=select-into-outfile-statement>Select into outfile statement</h3><p>Exports Results to a File on Server<br>File is Saved to datadir by Default<br>Fails if Another File with Same Name<br><code>FILE</code> Privilege Required<br>One Record per Line<br>Fields Separated by Tabs (<code>Ascii #9\t</code>) by Default</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>OUTFILE<span style=color:#bbb> </span><span style=color:#4070a0>&#39;/path/City.txt&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>City;<span style=color:#bbb>
</span></span></span></code></pre></div><p>Basic Example of <code>SELECT INTO OUTFILE</code> Syntax</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>OUTFILE<span style=color:#bbb> </span><span style=color:#4070a0>&#39;/path/City.csv&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>City<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>FIELDS<span style=color:#bbb> </span>TERMINATED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;,&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>ENCLOSED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;&#34;&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>ESCAPED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;\\&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>LINES<span style=color:#bbb> </span>TERMINATED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;\r\n&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>STARTING<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;Record: &#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><p>Examples of More Precise Format Options</p><h2 id=inserting-and-loading-data>Inserting and loading data</h2><h3 id=single-versus-multi-row-insert>Single versus multi-row insert</h3><p>Single Row <code>INSERT</code> Repeats Full Write Process for Each</p><ul><li>Increases Traffic</li><li>Parsing is Repeated (Unlike Query Cache for <code>SELECT</code>)</li><li>Index Rebuilt for Each <code>INSERT</code></li></ul><p>Multi-Row <code>INSERT</code> Minimizes Overhead</p><ul><li>Rows are Inserted in Batches</li><li>Requires only One Index Rebuild</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>table1<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> </span>(<span style=color:#4070a0>&#39;test&#39;</span>,<span style=color:#40a070>1</span>,<span style=color:#40a070>2</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>table1<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> </span>(<span style=color:#4070a0>&#39;test&#39;</span>,<span style=color:#40a070>1</span>,<span style=color:#40a070>2</span>);<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>table1<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> </span>(<span style=color:#4070a0>&#39;test&#39;</span>,<span style=color:#40a070>1</span>,<span style=color:#40a070>2</span>),<span style=color:#bbb> </span>(<span style=color:#4070a0>&#39;test&#39;</span>,<span style=color:#40a070>3</span>,<span style=color:#40a070>4</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><p>Write Process</p><ul><li>CONNECT</li><li>SEND</li><li>PARSE</li><li>INSERT</li><li>INDEX</li><li>DISCONNECT</li></ul><h3 id=multi-row-insert-caveats>Multi-row insert caveats</h3><p><strong>Multi-Row <code>INSERT</code> Statements are Transactions</strong></p><ul><li>All Rows must be Written to Commit Transaction with a Transactional Engines</li><li>Prior Rows Inserted if One fails with Non-Transactional Engine</li></ul><p><strong>Size is Set by <code>max_allowed_packet</code> Variable</strong></p><p><strong>Faster Loading of Large Data Sets</strong></p><ul><li>Used by Default by <code>mysqldump</code></li></ul><h3 id=insertselect-statement>Insert&mldr;select statement</h3><ul><li>Useful in copying data between tables<ul><li>Fields of <code>SELECT</code> must match <code>INSERT</code> column list</li></ul></li><li>No separate parse step required to insert data</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TABLE</span><span style=color:#bbb> </span>employees_personal<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>LIKE</span><span style=color:#bbb> </span>employees;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>employees_personal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>(emp_id,<span style=color:#bbb> </span>gender,<span style=color:#bbb> </span>birth_date)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>emp_id,<span style=color:#bbb> </span>gender,<span style=color:#bbb> </span>birth_date<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>employees;<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=duplicate-keys-statement>Duplicate keys statement</h3><p><code>DUPLICATE KEY</code> does a select then decides on insert versus update</p><p><code>REPLACE</code> does a delete then an insert</p><p>Existing Rows are Updated not Duplicated when using <code>ON DUPLICATE KEY UPDATE</code></p><p>Duplicates are Rows with same <code>PRIMARY</code> or <code>UNIQUE</code> Key Values</p><p>Only One is Updated even if Many Exist</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>parts<span style=color:#bbb> </span>(part_code,<span style=color:#bbb> </span>part)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> </span>(<span style=color:#4070a0>&#39;bt-45&#39;</span>,<span style=color:#4070a0>&#39;45mm Bolt&#39;</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span>DUPLICATE<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>KEY</span><span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>part_code<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>part_code<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;-1&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>parts<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span>part_code<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>part_code<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;-1&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>part_code<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;bt-45&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>INSERT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span>parts<span style=color:#bbb> </span>(part_code,<span style=color:#bbb> </span>part)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> </span>(<span style=color:#4070a0>&#39;bt-45&#39;</span>,<span style=color:#4070a0>&#39;45mm Bolt&#39;</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><p>This DUPLICATE KEYS statement is the equivalent of these statements ====></p><h3 id=load-data-infile-statement>Load data infile statement</h3><p>Imports Data Directly from File to Server</p><p>Put File in Data Directory or give</p><p>Full Path</p><p><code>FILE</code> Privilege Required</p><p>Use <code>LOAD DATA LOCAL INFILE</code> for File on Client Instead of Server</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>LOAD</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>DATA</span><span style=color:#bbb> </span>INFILE<span style=color:#bbb> </span><span style=color:#4070a0>&#39;/tmp/City.csv&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TABLE</span><span style=color:#bbb> </span>City<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>FIELDS<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>TERMINATED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;,&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>ENCLOSED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;&#34;&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>ESCAPED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;\\&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>LINES<span style=color:#bbb> </span>TERMINATED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;\r\n&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>STARTING<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;Record: &#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=importing-sql-files>Importing SQL files</h3><p>Import SQL Text Files using <code>mysql</code> Client from Command-Line</p><p>Fast Option and No Screen Output</p><p>Aborts on Errors by Default</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># mysql -u devuser -p world &lt; /path/to/world.sql</span>
</span></span></code></pre></div><h2 id=changing-and-deleting-data>Changing and deleting data</h2><h3 id=update-statement>Update statement</h3><p>Use <code>SET</code> Clause to Change Column Values</p><p>Several Optional Clauses (i.e., <code>JOIN</code>, <code>WHERE</code>, <code>ORDER BY</code>, <code>LIMIT</code>)</p><p>All Rows Changed Without <code>WHERE</code> or <code>LIMIT</code> Clause</p><p><code>ORDER BY</code> and <code>LIMIT</code> Are Not Compatible with <code>JOIN</code></p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>table1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>JOIN</span><span style=color:#bbb> </span>table2<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>USING</span>(id)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span>table1.col1<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;expression&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>table2.field4<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;whatever&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><p>Basic Syntax Example for <code>UPDATE</code> Statement</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>UPDATE</span><span style=color:#bbb> </span>City<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>SET</span><span style=color:#bbb> </span>Population<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>Population<span style=color:#bbb> </span><span style=color:#666>+</span><span style=color:#bbb> </span><span style=color:#40a070>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>CountryCode<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;FIN&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Query<span style=color:#bbb> </span>OK,<span style=color:#bbb> </span><span style=color:#40a070>7</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>rows</span><span style=color:#bbb> </span>affected<span style=color:#bbb> </span>(<span style=color:#40a070>0</span>.<span style=color:#40a070>00</span><span style=color:#bbb> </span>sec)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>Rows</span><span style=color:#bbb> </span>matched:<span style=color:#bbb> </span><span style=color:#40a070>7</span><span style=color:#bbb> </span>Changed:<span style=color:#bbb> </span><span style=color:#40a070>7</span><span style=color:#bbb> </span>Warnings:<span style=color:#bbb> </span><span style=color:#40a070>0</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=replace-statement>Replace statement</h3><p><strong><code>REPLACE</code> can be used instead of <code>INSERT</code> (MariaDB Extension to SQL)</strong></p><p>Deletes Duplicates in Table</p><p>Inserts New Rows</p><p>Duplicates are Rows with Same Value for <code>PRIMARY</code> or <code>UNIQUE</code> Key</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>REPLACE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INTO</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>table</span><span style=color:#bbb> </span>(columns)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VALUES</span><span style=color:#bbb> </span>(<span style=color:#007020;font-weight:700>values</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><p>Basic Syntax Example for <code>REPLACE</code> Statement</p><h3 id=delete-statement>Delete statement</h3><p>Specify Table or Tables from which to Delete Rows</p><ul><li><code>JOIN</code> Causes Deletions in Joined Tables</li></ul><p>Several Optional Clauses (i.e., <code>JOIN</code>, <code>WHERE</code>, <code>ORDER BY</code>, <code>LIMIT</code>)</p><p>All Rows Changed Without <code>WHERE</code> or <code>LIMIT</code> Clause</p><p><code>ORDER BY</code> and <code>LIMIT</code> Are Not Compatible with <code>JOIN</code></p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>DELETE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>table1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>JOIN</span><span style=color:#bbb> </span>table2<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>USING</span>(id)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>condition;<span style=color:#bbb>
</span></span></span></code></pre></div><p>Basic Syntax Example for <code>DELETE</code> Statement</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>DELETE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>City<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>CountryCode<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;FIN&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Query<span style=color:#bbb> </span>OK,<span style=color:#bbb> </span><span style=color:#40a070>7</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>rows</span><span style=color:#bbb> </span>affected<span style=color:#bbb> </span>(<span style=color:#40a070>0</span>.<span style=color:#40a070>02</span><span style=color:#bbb> </span>sec)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>Rows</span><span style=color:#bbb> </span>matched:<span style=color:#bbb> </span><span style=color:#40a070>7</span><span style=color:#bbb>  </span>Changed:<span style=color:#bbb> </span><span style=color:#40a070>7</span><span style=color:#bbb>  </span>Warnings:<span style=color:#bbb> </span><span style=color:#40a070>0</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=truncate-statement>Truncate statement</h3><p>Empties a table completely</p><p><code>TRUNCATE tablename [WAIT n|NOWAIT];</code></p><p>The <code>TRUNCATE &lt;tablename></code> statement will fail for an InnoDB table if any <code>FOREIGN KEY</code> constraints from other tables reference the table, returning the following error</p><p><code>ERROR 1701 (42000): Cannot truncate a table referenced in a foreign key constraint</code></p><p>Faster than a <code>DELETE</code> statement because it drops and re-creates the table</p><p>Will return a row count of 0 so if you need to know how many rows were removed, use the <code>DELETE</code> statement</p><p>Drops all historical records from a system-versioned table</p><h2 id=joins>Joins</h2><h3 id=joins-overview>Joins overview</h3><p>Joins combine records from two or more tables, using values common within each one</p><p>Rows from Table A are <em>joined</em> with rows from Table B</p><p>The result <em>set</em> has rows containing fields from both tables</p><p>Result may be returned to the client, placed into a new table, or used as an <em>implicit</em> table for further operations</p><p><code>INNER</code> <code>OUTER</code> <code>NATURAL</code><br><code>CROSS</code> <code>STRAIGHT_JOIN</code> <code>RIGHT</code><br><code>LEFT</code> <code>USING</code> <code>ON</code></p><h3 id=implicit-join-syntax>Implicit join syntax</h3><p>Join and Other <code>WHERE</code> Conditions Mingled</p><p>Without Constraints, the Result is a Full Cartesian Product</p><p><code>SELECT</code> cols<br><code>FROM</code> table, table2<br><code>WHERE</code> join-condition<br><code>AND</code> other-condition;</p><p>Basic Syntax Example for Joining Tables</p><p><code>SELECT</code> City.Name, Country.Name, City.Population<br><code>FROM</code> Country, City<br><code>WHERE</code> CountryCode = Code<br><code>AND</code> City.Population &lt; 100000;</p><p>Practical Example for Joining Tables within <code>WHERE</code> Clause</p><h3 id=explicit-join-syntax>Explicit join syntax</h3><p>With a <code>JOIN</code> Clause the Join Conditions are Separate</p><p>Other <code>WHERE</code> Clause Conditions are Not Mixed with Join Points</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>cols<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>table</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>JOIN</span><span style=color:#bbb> </span>table2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>join</span><span style=color:#666>-</span>condition<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>other<span style=color:#666>-</span>condition;<span style=color:#bbb>
</span></span></span></code></pre></div><p>Basic Syntax Example for <code>JOIN</code> Clause</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>City.Name,<span style=color:#bbb> </span>Country.Name,<span style=color:#bbb> </span>City.Population<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>Country<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>JOIN</span><span style=color:#bbb> </span>City<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span>CountryCode<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>Code<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>City.Population<span style=color:#bbb> </span><span style=color:#666>&lt;</span><span style=color:#bbb> </span><span style=color:#40a070>100000</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><p>Practical Example for Joining Tables with <code>JOIN</code> Clause</p><h3 id=inner-joins>Inner joins</h3><ul><li><p><code>JOIN</code> defaults to an <code>INNER JOIN</code></p><ul><li><code>INNER</code> keyword is optional</li><li>In MariaDB a <code>CROSS JOIN</code> is the same as an <code>INNER JOIN</code></li></ul></li><li><p>Without filtering, result is a cartesian product</p><ul><li>Every matched row in table1 is joined to every matched row in table2</li><li><code>ON</code> clause is optional; without it, every row in both table matches</li><li>Can quickly become a large result set!</li></ul></li><li><p>Only returns rows when there is a match in both tables</p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>cols<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>table</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>INNER</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>JOIN</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>table2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>join</span><span style=color:#666>-</span>condition<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>other<span style=color:#666>-</span>conditions;<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=outer-joins>Outer joins</h3><p><code>LEFT JOIN</code> really means <code>LEFT OUTER JOIN</code></p><ul><li><code>OUTER</code> keyword is optional</li><li><code>RIGHT JOIN</code> is also available</li></ul><p>An <code>OUTER JOIN</code> does not require matches in both tables</p><ul><li>For <code>LEFT JOIN</code> every matching row from the left table is returned</li><li>If no corresponding match in the right table, fields are <code>NULL</code></li><li>Vice versa for <code>RIGHT JOIN</code></li></ul><p>MariaDB does not support full outer join</p><ul><li>It can be simulated using a <code>UNION</code> between <code>LEFT</code> and <code>RIGHT</code> joins</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>cols<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>table</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>LEFT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>JOIN</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>table2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>join</span><span style=color:#666>-</span>condition<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>other<span style=color:#666>-</span>conditions;<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=outer-join-example>Outer join example</h3><p><code>SELECT cols FROM table LEFT JOIN table2 ON join-condition WHERE other-conditions;</code></p><p><code>SELECT Country.Name as Country, City.Name as Capital FROM Country LEFT JOIN City ON Capital = City.Id WHERE Country.Name LIKE 'B%';</code></p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------------------------+--------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Country<span style=color:#bbb>                       </span><span style=color:#666>|</span><span style=color:#bbb> </span>Capital<span style=color:#bbb>      </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------------------------+--------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Bulgaria<span style=color:#bbb>                      </span><span style=color:#666>|</span><span style=color:#bbb> </span>Sofija<span style=color:#bbb>       </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Burkina<span style=color:#bbb> </span>Faso<span style=color:#bbb>                  </span><span style=color:#666>|</span><span style=color:#bbb> </span>Ouagadougou<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Burundi<span style=color:#bbb>                       </span><span style=color:#666>|</span><span style=color:#bbb> </span>Bujumbura<span style=color:#bbb>    </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Belarus<span style=color:#bbb>                       </span><span style=color:#666>|</span><span style=color:#bbb> </span>Minsk<span style=color:#bbb>        </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Bouvet<span style=color:#bbb> </span>Island<span style=color:#bbb>                 </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span><span style=color:#bbb>         </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#666>&lt;-</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>no</span><span style=color:#bbb> </span>capital<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>British<span style=color:#bbb> </span>Indian<span style=color:#bbb> </span>Ocean<span style=color:#bbb> </span>Territory<span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span><span style=color:#bbb>         </span><span style=color:#666>|</span><span style=color:#bbb> </span><span style=color:#666>&lt;-</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>no</span><span style=color:#bbb> </span>capital<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-------------------------------+--------------+
</span></span></span></code></pre></div><h3 id=natural-joins>Natural joins</h3><ul><li><p>Compare columns common to table a and b</p></li><li><p>Column names must match exactly</p></li><li><p>Result set holds one column for each matching pair</p></li><li><p>Generally considered dangerous!</p></li><li><p>The join conditions are not obvious or easy to debug</p></li><li><p>What happens when the schema changes?</p><ul><li>If fields with the same names are added to both tables?</li><li>If a field is dropped from one table, but not the other?</li><li>There will be no explicit error, but the result set will change!</li></ul></li></ul><h3 id=general-tips>General tips</h3><p>Cartesian products of table subsets, with variations</p><p><strong>The optimizer does a lot for you such as:</strong></p><ul><li>Orders tables for minimum cost (fewest rows examined)</li><li>Converts <code>OUTER</code> to <code>INNER</code> when possible</li></ul><p><strong>Other performance considerations to consider:</strong></p><ul><li>Ensure columns in <code>ON</code> and <code>USING</code> clauses are indexed</li><li>Try to keep <code>GROUP BY</code> and <code>ORDER BY</code> columns in one table, so that an index may be used (if available)</li><li>Consider <em>join decomposition</em> (very application specific)</li></ul><h3 id=general-tips-1>General tips</h3><h4 id=watch-for-ambiguous-column-references>Watch for ambiguous column references</h4><p>Example: If two tables contain a <code>Name</code> field</p><p>Use full notation such as: <code>tableA.Name = tableB.Name</code></p><h4 id=use-table-aliases-to-shorten-and-simplify-queries>Use table aliases to shorten and simplify queries</h4><p>An alias is just an alternative name for a table, within this query</p><p>The <code>AS</code> keyword is optional</p><p>Makes for easier reading and easier typing!</p><p>Less work required when tables are renamed</p><p>Ensures column names are never ambiguous</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>...<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>TableA<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>a,<span style=color:#bbb> </span>TableB<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>b<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>a.Name<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>b.Name;<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=general-tips-2>General tips</h3><p>Tables in joins are not necessarily processed in the same order they are listed in the query<br>MariaDB&rsquo;s Optimizer will move them around for efficiency<br>This does not affect the result set from a relational point of view<br>Use <code>STRAIGHT_JOIN</code> to control table join order, but generally only for debugging! The optimizer is really very good at its job</p><p>Beware that cartesian products can grow very large<br>Particularly when more than two tables are involved</p><p>Use inner joins over outer joins, where possible<br>Unless outer is explicitly required by the application<br>As a rule the working and result sets are smaller for inner joins<br>Unexpected <code>NULLs</code> make applications fall over (ie, when data changes)</p><p>Avoid using comma joins in queries to attain readability, flexibility and portability</p><h2 id=subqueries>Subqueries</h2><h3 id=subqueries-1>Subqueries</h3><p>Queries within Other Queries Entered within Parentheses</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>Language</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>CountryLanguage<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>CountryCode<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span>(<span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Code<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>Country<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>Name<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;Finland&#39;</span>);<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=scalar-subquery>Scalar subquery</h3><ul><li><p>Returns a Single Value</p><ul><li>Result Set must be One Row with One Column</li></ul></li><li><p>NULL is Returned for an Empty Result Set</p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Country.Name,<span style=color:#bbb> </span><span style=color:#40a070>100</span><span style=color:#bbb> </span><span style=color:#666>*</span><span style=color:#bbb> </span>CountryPopulation<span style=color:#bbb> </span><span style=color:#666>/</span><span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>(<span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SUM</span>(Population)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>Country)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>pct_world_pop<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>Country;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------------------+--------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>                </span><span style=color:#666>|</span><span style=color:#bbb> </span>pct_world_pop<span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>---------------------+--------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Afghanistan<span style=color:#bbb>         </span><span style=color:#666>|</span><span style=color:#bbb>      </span><span style=color:#40a070>0</span>.<span style=color:#40a070>3738</span><span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Netherlands<span style=color:#bbb>         </span><span style=color:#666>|</span><span style=color:#bbb>      </span><span style=color:#40a070>0</span>.<span style=color:#40a070>2610</span><span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>Netherlands<span style=color:#bbb> </span>Antilles<span style=color:#666>|</span><span style=color:#bbb>      </span><span style=color:#40a070>0</span>.<span style=color:#40a070>0036</span><span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>...<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=row-subqueries>Row subqueries</h3><p>Row subqueries return a single row</p><p>The subquery result set must be <em>one row with 2+ cols</em></p><p>Use with equality operators
=, &lt;>, !=, &lt;=></p><p>Use with comparison operators
&lt;, >, >=, &lt;=</p><p>Column order is important here!</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>(<span style=color:#4070a0>&#39;London&#39;</span>,<span style=color:#bbb> </span><span style=color:#4070a0>&#39;GBR&#39;</span>)<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>(<span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Name,<span style=color:#bbb> </span>CountryCode<span style=color:#bbb> 
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>City<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>ID<span style=color:#bbb> </span><span style=color:#666>=</span><span style=color:#bbb> </span><span style=color:#40a070>456</span>)<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>is_london;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>is_london<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-----------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb>         </span><span style=color:#40a070>0</span><span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>-----------+
</span></span></span></code></pre></div><h3 id=table-subquery-result-set>Table subquery result set</h3><p>Table subqueries return an <em>implicit</em> table</p><p>The subquery result may contain zero or more rows</p><p>Can be used in a <code>FROM</code> clause with a table alias</p><p>Use with <code>WHERE</code> and <code>IN</code>, <code>EXISTS</code>, <code>ANY</code>, <code>ALL</code> or <code>SOME</code></p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span><span style=color:#666>*</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>(<span style=color:#007020;font-weight:700>SELECT</span><span style=color:#bbb> </span>Code,<span style=color:#bbb> </span>Name<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>FROM</span><span style=color:#bbb> </span>Country<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>WHERE</span><span style=color:#bbb> </span>IndepYear<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>IS</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NOT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>NULL</span>)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>AS</span><span style=color:#bbb> </span>independent_countries;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>------+---------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>Code<span style=color:#bbb> </span><span style=color:#666>|</span><span style=color:#bbb> </span>Name<span style=color:#bbb>          </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>+</span><span style=color:#60a0b0;font-style:italic>------+---------------+
</span></span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic></span><span style=color:#666>|</span><span style=color:#bbb> </span>AFG<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span>Afghanistan<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>|</span><span style=color:#bbb> </span>NLD<span style=color:#bbb>  </span><span style=color:#666>|</span><span style=color:#bbb> </span>Netherlands<span style=color:#bbb>   </span><span style=color:#666>|</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>...<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=rewriting-to-joins>Rewriting to joins</h3><p>Why rewrite a perfectly good subquery into a join?</p><p>In some cases, joins still outperform subqueries<br>The MariaDB Optimizer is more mature for joins&mldr;though it is getting better all the time!</p><p>Non-correlated subqueries generally perform well<br>They do not reference the outer query and are executed just once<br>Can be executed alone</p><p>Correlated subqueries can lead to performance traps<br>They depend on the outer query and may be executed repeatedly<br>Cannot be executed alone</p><h3 id=rewriting-to-joins-1>Rewriting to joins</h3><p><strong>IN</strong> subqueries can be an <strong>INNER JOIN</strong><br>Same concept: An inner join only returns rows that match<br>May require use of <code>DISTINCT</code></p><p><strong>NOT IN</strong> subqueries can be an <strong>OUTER JOIN</strong><br><code>LEFT JOIN</code> and <code>WHERE ... IS NULL</code></p><p>Sometimes, the equivalent join is much more complex<br>For example using subqueries in the <code>FROM</code> clause for easy aggregation<br>Or using subqueries used for accessing hierarchical data</p><h2 id=lesson-summary>Lesson summary</h2><ul><li>Know how to select, insert, load, change and delete data</li><li>Explain how to execute outer and inner joins, and join a table to itself</li><li>Know how to use correct SQL syntax when creating subqueries within a statement, and demonstrate how to convert subqueries into joins</li><li>Describe and use window functions and common table expressions (CTEs)</li></ul><h2 id=lab-exercises>Lab exercises</h2><ul><li>5-1 Exporting and Importing Data Using mariadb-dump</li><li>5-2 Exporting and Importing Data Using MariaDB Backup</li><li>5-3 Exporting and Importing Data Using Database Statements</li><li>5-4 Using Different Types of Joins in Queries</li><li>5-5 Using and Optimizing Different Types of Subqueries</li><li>5-6 Using Common Table Expressions</li><li>5-7 Using Window Functions</li><li>5-8 Rolling Back a Transaction</li><li>5-9 Observing a Deadlock</li></ul><hr><p>For academic and non-commercial usage, licensed under CC BY-NC-SA 4.0 by MariaDB plc.</p></div><div class=right-menu><div class=quick-links><a href=https://github.com/MariaDB/mariadb-for-universities/blob/main/mariadb-dev-04-data-manipulation-and-extraction.md class="icon-link edit-page">View page source</a>
<a href=https://github.com/MariaDB/mariadb-for-universities/edit/main/mariadb-dev-04-data-manipulation-and-extraction.md class="icon-link view-source">Edit this page</a>
<a href="https://github.com/MariaDB/mariadb-for-universities/issues/new?title=Course%20Material%20issue%20for%20Lesson%204%3a%20Data%20manipulation%20and%20extraction&body=I%20found%20an%20issue%20with%20the%20documentation%20for%20Lesson%204%3a%20Data%20manipulation%20and%20extraction.%0A%0A%0A%0A---%0A%0AThis%20issue%20is%20related%20to%20the%20following%20page%3A%0A%0Ahttps%3a%2f%2funi.mariadb.org%2fdev%2fdata-manipulation-and-extraction%2f" class="icon-link create-doc">Create material issue</a>
<a href=javascript:void(0) onclick=printSection() class="icon-link print">Print entire section</a></div></div></div><script>function printSection(){const e=document.querySelector(".left-menu"),t=document.querySelector(".right-menu"),n=e.style.display,s=t.style.display;e.style.display="none",t.style.display="none",window.print(),e.style.display=n,t.style.display=s}</script></body></html>