<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>MariaDB for Universities Program: Course Material</title>
<link rel=stylesheet href=/css/main.css><meta property="og:url" content="https://uni.mariadb.org/dba/backup-and-restore/"><meta property="og:site_name" content="MariaDB for Universities Program Course Material"><meta property="og:title" content="Lesson 6: Backup and Restore"><meta property="og:description" content="Backup and Restore Learning Objectives Explain key backup principles and their importance, including the importance of verifying and testing backups Demonstrate and compare how to create full backups using different backup methods such as MariaDB Backup and mariadb-dump Apply and assess recovery methods to restore data in MariaDB Design and implement a backup and recovery plan and schedule Backing Up Data Backup Principles Helps ensure high availability
Cannot prevent user errors"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="dba"><meta property="article:published_time" content="2025-04-07T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-07T00:00:00+00:00"></head><body><div class=top-menu><div class=menu-left><a href=/ class=home-link>MariaDB for Universities Program: Course Material</a></div><div class=menu-right><a href=https://mariadb.org>MariaDB Foundation (mariadb.org)</a></div></div><div class=content-wrapper><div class=left-menu><div class=table-of-contents><h2><a href=.>Lesson 6: Backup and Restore</a></h2><nav id=TableOfContents><ul><li><a href=#learning-objectives>Learning Objectives</a></li><li><a href=#backing-up-data>Backing Up Data</a><ul><li><a href=#backup-principles>Backup Principles</a></li><li><a href=#basic-types-of-backup-methods>Basic Types of Backup Methods</a></li><li><a href=#mariadb-backup>MariaDB Backup</a></li><li><a href=#backing-up-data---mariadb-backup>Backing Up Data - MariaDB Backup</a></li><li><a href=#backing-up-data---mariadb-dump>Backing Up Data - MariaDB-dump</a></li><li><a href=#planning-and-scheduling-backups>Planning and Scheduling Backups</a></li></ul></li><li><a href=#restoring-data>Restoring Data</a><ul><li><a href=#restoring-data---mariadb-backup>Restoring Data - MariaDB Backup</a></li><li><a href=#restoring-data---mariadb-dump>Restoring Data - MariaDB-dump</a></li><li><a href=#verifying-backups>Verifying Backups</a></li></ul></li><li><a href=#lesson-summary>Lesson Summary</a></li></ul></nav></div></div><div class=main-content><nav class=breadcrumb><a href=/>MariaDB for Universities Course Material</a>
>
<a href=/dba/>MariaDB DBA Course</a>
> <span class=current>Lesson 6: Backup and Restore</span></nav><h1>Lesson 6: Backup and Restore</h1><h1 id=backup-and-restore>Backup and Restore</h1><h2 id=learning-objectives>Learning Objectives</h2><ul><li>Explain key backup principles and their importance, including the importance of verifying and testing backups</li><li>Demonstrate and compare how to create full backups using different backup methods such as <code>MariaDB Backup</code> and <code>mariadb-dump</code></li><li>Apply and assess recovery methods to restore data in MariaDB</li><li>Design and implement a backup and recovery plan and schedule</li></ul><h2 id=backing-up-data>Backing Up Data</h2><h3 id=backup-principles>Backup Principles</h3><ul><li><p>Helps ensure high availability</p></li><li><p>Cannot prevent user errors</p></li><li><p>Backup data, logs, and configuration files</p></li><li><p>Store backups in multiple locations</p><ul><li>Onsite for fast access</li><li>Offsite for security</li></ul></li><li><p>Create consistent backups</p></li><li><p>Backup methods</p><ul><li>Physical Backup</li><li>Logical Backup</li></ul></li><li><p>Binary logs for Point-in-Time recovery</p></li><li><p><strong>Always test the backup and recovery regularly</strong></p></li></ul><h3 id=basic-types-of-backup-methods>Basic Types of Backup Methods</h3><h4 id=physical-or-binary-backup>Physical or Binary Backup</h4><p>MariaDB Backup, manual data directory copy (after stopping the MariaDB daemon), or VM/Cloud/LVM/ZFS snapshots</p><ul><li>A physical backup typically refers to a copy of the entire on disk database</li><li>Used to mitigate a single or multiple host failure</li><li>Can build replicas quickly</li><li>Quick full recovery time</li><li>Slow to recover single row or table (user error)</li><li>Recovered only to the same storage engine with the same tablespaces</li></ul><h4 id=logical-backup>Logical Backup</h4><p><code>mariadb-dump</code>, <code>mydumper</code>, <code>SELECT INTO OUTFILE</code></p><ul><li>Produces SQL files containing data that can regenerate a database</li><li>Easily backup and restore single row, table, or database</li><li>Can separate schema and data</li><li>Can work across versions and forks</li><li>SQL can be parsed with standard UNIX tools</li><li>Restore process automatically replicated</li><li>Long full restore time</li><li>A SQL dump is independent of storage engine, and can be restored to a different storage engine, or used for migration</li><li>Process can be slow and requires locks</li></ul><h3 id=mariadb-backup>MariaDB Backup</h3><p><em>MariaDB&rsquo;s own backup package</em> (<code>mariabackup</code>) <em>is available from MariaDB repositories</em></p><ul><li>Supports MariaDB&rsquo;s features and storage engines</li><li>Supports encryption</li><li>Supports incremental backups</li><li>Also available on Windows</li><li>MariaDB Enterprise Backup contains improvements such as reduced locking</li></ul><h3 id=backing-up-data---mariadb-backup>Backing Up Data - MariaDB Backup</h3><h4 id=full-backups>Full Backups</h4><p>To use MariaDB Backup you need to create a user on your MariaDB Server with <code>RELOAD</code>, <code>LOCK TABLES</code> and <code>REPLICATION CLIENT</code> privileges.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>MariaDB<span style=color:#bbb> </span>[(<span style=color:#007020;font-weight:700>none</span>)]<span style=color:#666>&gt;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>USER</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;&lt;backupuser&gt;&#39;</span><span style=color:#666>@</span><span style=color:#4070a0>&#39;localhost&#39;</span><span style=color:#bbb> </span>IDENTIFIED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;&lt;password&gt;&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>MariaDB<span style=color:#bbb> </span>[(<span style=color:#007020;font-weight:700>none</span>)]<span style=color:#666>&gt;</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>GRANT</span><span style=color:#bbb> </span>RELOAD,<span style=color:#bbb> </span>PROCESS,<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>LOCK</span><span style=color:#bbb> </span>TABLES,<span style=color:#bbb> </span>REPLICATION<span style=color:#bbb> </span>CLIENT<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span><span style=color:#666>*</span>.<span style=color:#666>*</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TO</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;&lt;backupuser&gt;&#39;</span><span style=color:#666>@</span><span style=color:#4070a0>&#39;localhost&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><p>To take a full backup at the OS command-line use:</p><pre tabindex=0><code># mariabackup --backup --target-dir &lt;backupdir&gt; --user &lt;backupuser&gt; --password &lt;password&gt;
# mariabackup --prepare --target-dir &lt;backupdir&gt;
</code></pre><h3 id=backing-up-data---mariadb-dump>Backing Up Data - MariaDB-dump</h3><p>The standard MariaDB logical dump tool copies schema and data to a SQL text file</p><p>To use <code>mariadb-dump</code> you need to create a user on your MariaDB Server with <code>SELECT</code>, <code>RELOAD</code>, <code>LOCK TABLES</code>, <code>REPLICATION CLIENT</code>, <code>SHOW VIEW</code>, <code>EVENT</code>, and <code>TRIGGER</code> privileges</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#007020;font-weight:700>CREATE</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>USER</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;backupuser&#39;</span><span style=color:#666>@</span><span style=color:#4070a0>&#39;localhost&#39;</span><span style=color:#bbb> </span>IDENTIFIED<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>BY</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;mariadb&#39;</span>;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#007020;font-weight:700>GRANT</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SELECT</span>,<span style=color:#bbb> </span>RELOAD,<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>LOCK</span><span style=color:#bbb> </span>TABLES,<span style=color:#bbb> </span>REPLICATION<span style=color:#bbb> </span>CLIENT,<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>SHOW</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>VIEW</span>,<span style=color:#bbb> </span>EVENT,<span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TRIGGER</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>ON</span><span style=color:#bbb> </span><span style=color:#666>*</span>.<span style=color:#666>*</span><span style=color:#bbb> </span><span style=color:#007020;font-weight:700>TO</span><span style=color:#bbb> </span><span style=color:#4070a0>&#39;backupuser&#39;</span><span style=color:#666>@</span><span style=color:#4070a0>&#39;localhost&#39;</span>;<span style=color:#bbb>
</span></span></span></code></pre></div><p>To take a full backup at the OS command line use</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># mariadb-dump -u backupuser -p --all-databases --single-transaction --flush-logs -r /path/to/full-backup-YYYYMMDD.sql</span>
</span></span></code></pre></div><h3 id=planning-and-scheduling-backups>Planning and Scheduling Backups</h3><p>Take inventory of databases</p><ul><li>List of databases & tables</li><li>Number of rows</li><li>Frequency of changes</li><li>How active</li><li>Sensitivity of data</li></ul><p>Write a backup schedule</p><p>Write a verification schedule</p><p>Verify and practice restoring from backups</p><ul><li>Backups are useless unless they have been tested</li><li>Recovery procedures should be tested at least once per quarter</li><li>Keep track of restore times during tests</li></ul><p>Naming standard for backup files</p><p>Frequency — days and times</p><p>Location — security and off-site</p><h2 id=restoring-data>Restoring Data</h2><h3 id=restoring-data---mariadb-backup>Restoring Data - MariaDB Backup</h3><h4 id=full-backups-1>Full Backups</h4><p>Working with a full backup taken with MariaDB Backup, you restore the backup into an <em>empty</em> data directory</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># mariabackup --copy-back --target-dir &lt;backupdir&gt; --datadir &lt;datadir&gt;</span>
</span></span></code></pre></div><p>Afterwards it might be necessary to set the ownership of the data directory contents</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># chown -R mysql:mysql &lt;datadir&gt;</span>
</span></span></code></pre></div><h3 id=restoring-data---mariadb-dump>Restoring Data - MariaDB-dump</h3><p>Restoring from a logical backup</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># mariadb &lt; /path/to/full-backup-YYYYMMDD.sql</span>
</span></span></code></pre></div><p>Or to avoid interpretation by the shell</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># mariadb</span>
</span></span><span style=display:flex><span>SOURCE /path/to/full-backup-YYYYMMDD.sql
</span></span></code></pre></div><p>You can also use standard linux tools such as <code>vi</code> or <code>grep</code> to edit or extract the backup</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># grep city worldbackup.sql</span>
</span></span><span style=display:flex><span>CREATE TABLE <span style=color:#4070a0>`</span>world<span style=color:#4070a0>`</span>.<span style=color:#4070a0>`</span>city<span style=color:#4070a0>`</span> <span style=color:#666>(</span> ...
</span></span></code></pre></div><h3 id=verifying-backups>Verifying Backups</h3><ul><li>Backups do not exist until you are certain they can be recovered so prepare a backup immediately</li><li>Some of the reasons for preparing backups are to:<ul><li>Enable recovery during a disaster</li><li>Migrate to a new server</li><li>Build a new replica</li><li>Build a test environment that is cloned from production</li></ul></li><li>Recovery procedures should be tested on a regular basis, at least once a quarter</li><li>Validate the correctness of your backups</li><li>Provide metrics on recovery time and recovery point</li><li>Test by refreshing data to stage/test or development</li><li>Test different kinds of restores as well<ul><li>Do I know how to restore all of the data?</li><li>Do I know how to restore just a single table?</li><li>Do I know how to perform Point-in-Time recovery?</li><li>Do I know how to restore a replica?</li></ul></li><li>Restore and check for:<ul><li>Errors</li><li>Data Size</li><li>Checksums</li><li>Resultsets</li></ul></li></ul><h2 id=lesson-summary>Lesson Summary</h2><ul><li>Explain key backup principles and their importance, including the importance of verifying and testing backups</li><li>Demonstrate and compare how to create full backups using different backup methods such as <code>MariaDB Backup</code> and <code>mariadb-dump</code></li><li>Apply and assess recovery methods to restore data in MariaDB</li><li>Design and implement a backup and recovery plan and schedule</li></ul><hr><p>For academic and non-commercial usage, licensed under CC BY-NC-SA 4.0 by MariaDB plc.</p></div><div class=right-menu><div class=quick-links><a href=https://github.com/MariaDB/mariadb-for-universities/blob/main/mariadb-dba-06-backup-and-restore.md class="icon-link edit-page">View page source</a>
<a href=https://github.com/MariaDB/mariadb-for-universities/edit/main/mariadb-dba-06-backup-and-restore.md class="icon-link view-source">Edit this page</a>
<a href="https://github.com/MariaDB/mariadb-for-universities/issues/new?title=Course%20Material%20issue%20for%20Lesson%206%3a%20Backup%20and%20Restore&body=I%20found%20an%20issue%20with%20the%20documentation%20for%20Lesson%206%3a%20Backup%20and%20Restore.%0A%0A%0A%0A---%0A%0AThis%20issue%20is%20related%20to%20the%20following%20page%3A%0A%0Ahttps%3a%2f%2funi.mariadb.org%2fdba%2fbackup-and-restore%2f" class="icon-link create-doc">Create material issue</a>
<a href=javascript:void(0) onclick=printSection() class="icon-link print">Print entire section</a></div></div></div><script>function printSection(){const e=document.querySelector(".left-menu"),t=document.querySelector(".right-menu"),n=e.style.display,s=t.style.display;e.style.display="none",t.style.display="none",window.print(),e.style.display=n,t.style.display=s}</script></body></html>